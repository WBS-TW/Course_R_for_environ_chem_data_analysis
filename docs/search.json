[
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "R for Environmental Chemistry Data Analysis",
    "section": "",
    "text": "1 Course content\nThis is the handbook for the PhD course on R for environmental chemistry data analysis"
  },
  {
    "objectID": "index.html#recommended-literature",
    "href": "index.html#recommended-literature",
    "title": "R for Environmental Chemistry Data Analysis",
    "section": "1.1 Recommended literature:",
    "text": "1.1 Recommended literature:\nIntroduction to Programming with R. https://discdown.org/rprogramming/introduction.html\nHands-On Programming with R. https://rstudio-education.github.io/hopr/\nR for Data Science (2e). Hadley Wickham. Freely available at: https://r4ds.hadley.nz/\nR for Data Science: Exercise Solutions. https://jrnold.github.io/r4ds-exercise-solutions/\nR Graphics Cookbook, 2nd edition. Winston Chang. Freely available at: https://r-graphics.org/\nPosit Cheatsheets: https://posit.co/resources/cheatsheets/\nStatistical Inference via Data Science: A ModernDive into R and the Tidyverse. https://moderndive.com/index.html\nInteractive web-based data visualization with R, plotly, and shiny. https://plotly-r.com/\nData Visualization: A practical introduction. Kieran Healy. https://socviz.co/\nMastering Software Development in R: https://bookdown.org/rdpeng/RProgDA/\nTo learn more about Quarto books visit:\n\nhttps://quarto.org/docs/books\nhttps://r4ds.hadley.nz/quarto.html\nhttps://quarto.org/docs/computations/execution-options.html\n\nSome useful links to other R for data science books:\n\nhttps://www.r4epi.com/installing-r-and-rstudio"
  },
  {
    "objectID": "index.html#plan-for-course",
    "href": "index.html#plan-for-course",
    "title": "R for Environmental Chemistry Data Analysis",
    "section": "1.2 Plan for course",
    "text": "1.2 Plan for course\nThe final report will be an online book with chapters with one containing a learning diary, and others should contain a scientific report documenting the descriptive analysis and visualization of environmental chemistry relevant data sets.\nStart with R software\nhttps://moderndive.com/1-getting-started.html\n\nInstall R and RStudio\nInstall RTools\n\n-Install packages\n-Managing R with .Rprofile,..: https://support.posit.co/hc/en-us/articles/360047157094-Managing-R-with-Rprofile-Renviron-Rprofile-site-Renviron-site-rsession-conf-and-repos-conf\n\n1.2.0.1 Basic R\n\nBasic concepts\nData types: vector, dataframe, list,…\nUsing base R functions: c, paste,..\nUsing functions from installed packages\n\n– library()\n– Use help “?”\n\nIf statements, for loops\nBasic plotting\nImporting excel, csv,..\n\nUsing version control with Git and Github\n\nVersion Control with Git and SVN: https://support.posit.co/hc/en-us/articles/200532077-Version-Control-with-Git-and-SVN\nHappy Git and GitHub for the user: https://happygitwithr.com/\n\nWriting and creating markdown documents\n\nMarkdown syntax: https://quarto.org/docs/authoring/markdown-basics.html\nQuarto Books: https://quarto.org/docs/books/\nQuarto blog: https://albert-rapp.de/posts/13_quarto_blog_writing_guide/13_quarto_blog_writing_guide.html\n\n\n\n1.2.0.2 Tidyverse\n\nTidyverse concepts\nThe pipe: %&gt;% or |&gt;  https://www.tidyverse.org/blog/2023/04/base-vs-magrittr-pipe/\nggplot2: https://ggplot2.tidyverse.org/\ndplyr: https://dplyr.tidyverse.org/\npivot\n\n\n\ntidyr: https://tidyr.tidyverse.org/\nreadr, readxl: https://readr.tidyverse.org/ ; https://readxl.tidyverse.org/\n\n\n\n1.2.0.3 Interactive plotting with R\n\nJavascript and htmlwidgets: https://www.htmlwidgets.org/\nPlotly: https://plotly.com/r/  \nDT: https://rstudio.github.io/DT/\n\n\n\n1.2.0.4 Statistics\n\nBasic stats\nComparison between groups (t-test, K-W, ANOVA,…)\nRegression/correlation\nMultivariate statistics (PCA, HCA,…)\n\n\n\n1.2.0.5 ChatGPT\n\n\n1.2.0.6 Database (optional)\n-        Relational database management system, MySQL\no   https://www.hostinger.com/tutorials/database-schema\no   …\n-        dbplyr: https://dbplyr.tidyverse.org/\nSession information with the versions of different packages"
  },
  {
    "objectID": "1_Basic_R.html#data-types-in-r",
    "href": "1_Basic_R.html#data-types-in-r",
    "title": "2  Familiarize yourself with R",
    "section": "2.1 Data types in R",
    "text": "2.1 Data types in R\nBasic data types in R can be divided into the following types:\n\nnumeric : (10.5, 55, 787)\ninteger (a.k.a. double) : (1L, 55L, 100L, where the letter “L” declares this as an integer)\ncomplex : (9 + 3i, where “i” is the imaginary part)\ncharacter (a.k.a. string) : (“k”, “R is exciting”, “FALSE”, “11.5”)\nlogical (a.k.a. boolean) : (TRUE or FALSE)\n\nWe can use the class() function to check the data type of a variable:\nNumeric (also called double)\n\nx &lt;- 10.5\nclass(x)\n\n[1] \"numeric\"\n\n\nInteger\n\nx &lt;- 1000L\nclass(x)\n\n[1] \"integer\"\n\n\nComplex\n\n# We will not deal with complex data in this course\nx &lt;- 9i + 3\nclass(x)\n\n[1] \"complex\"\n\n\nCharacter/String\n\nx &lt;- \"Hello World\"\n\n# You can also use str() to check the data type of an object. This function will give more detailed information about the elements in the object\nstr(x)\n\n chr \"Hello World\"\n\n\nLogical/Boolean\n\n# a vector of logical/boolean\nx &lt;- c(TRUE, FALSE)\n\nstr(x)\n\n logi [1:2] TRUE FALSE\n\n\nIf you concatenate elements of different data types in a vector, then R will convert the elements in the following order: 1. string; 2. numeric; 3. integer; 4. logical. It means that all other data types will be converted to a string if you combine these elements with a string element.\n\n# If you want to create (or convert) an object of a specific data type, then use the as.xxx functions.\n\na_string &lt;- as.character(\"A Space Odyssey\")\n# You can also skip the as.character and directly use: a_string &lt;- \"A Space Odyssey\". R will recognize is as a string and automatically choose the correct data type.\na_integer &lt;- as.integer(2001)\na_numeric &lt;- as.numeric(99.999)\na_logical &lt;-  as.logical(TRUE)\n\n\n\nc(a_integer, a_string)\n\n[1] \"2001\"            \"A Space Odyssey\"\n\nc(a_integer, a_numeric)\n\n[1] 2001.000   99.999\n\nc(a_integer, a_logical)\n\n[1] 2001    1\n\n\nYou cannot create a datatype that R doesn’t recognize\n\nobject1 &lt;- as.integer(\"Hello\")\n\nWarning: NAs introduced by coercion\n\nstr(object1)\n\n int NA"
  },
  {
    "objectID": "1_Basic_R.html#data-structures-in-r",
    "href": "1_Basic_R.html#data-structures-in-r",
    "title": "2  Familiarize yourself with R",
    "section": "2.2 Data structures in R",
    "text": "2.2 Data structures in R\nBelow are some basic data structures in R:\n\nvectors\nlists\nmatrices\ndataframes\nfactors\n\nVectors\n\nvectors: also called atomic vectors, where all elements must be of the same basic data types.\n\n\n# A string vector\na_vector_strings &lt;- c(\"This\", \"is\", \"a\", \"vector\", \"of\", \"string\", \"elements\")\nstr(a_vector_strings)\n\n chr [1:7] \"This\" \"is\" \"a\" \"vector\" \"of\" \"string\" \"elements\"\n\n\n\n# integer vectors\na_vector_integers1 &lt;- c(99, 98)\na_vector_integers2 &lt;- c(1, 2, 3, 4, 5)\n\nstr(a_vector_integers1)\n\n num [1:2] 99 98\n\n\nWhat happens when we perform operations with two or more vectors of different length? First, we can use the length() function to check the length of an object\n\nlength(a_vector_integers1)\n\n[1] 2\n\nlength(a_vector_integers2)\n\n[1] 5\n\n\nWe can use == as an equal operator to check if both vectors have the same length\n\nlength(a_vector_integers1) == length(a_vector_integers2)\n\n[1] FALSE\n\n\nWe can see that this will be FALSE since the length of the two vectors are not equal.\nThe opposite is to use the `!=` (not equal to) operator:\n\nlength(a_vector_integers1)!= length(a_vector_integers2)\n\n[1] TRUE\n\n\nFinally, we can see that when performing addition operation of a_vector_integers1 (99, 98) with a_vector_integers2 (1, 2, 3, 4, 5), R will recycle the shorter vector\n\ncombine_vectors &lt;- a_vector_integers1 + a_vector_integers2\n\nWarning in a_vector_integers1 + a_vector_integers2: longer object length is not\na multiple of shorter object length\n\nstr(combine_vectors)\n\n num [1:5] 100 100 102 102 104\n\n\nR will therefore perform the element-wise operations 99+1, 98+2, 99+3, 98+4, 99+5, and the resulting object will have the same length as a_vector_integers2.\nMatrices\nA matrix is a 2 dimensional data structure for vectors of the same datatype.\nLists\nWe can also store elements of different datatypes in list objects.\n\na_vector_integers1 &lt;- c(99, 98)\n\na_vector_strings &lt;- c(\"This\", \"is\", \"a\", \"vector\", \"of\", \"string\", \"elements\")\n\n# In this case, we use the list() function.\na_list &lt;- list(vec_int = a_vector_integers1, \n               vec_str = a_vector_strings)\n\n# If you dont name the elements within the list then these will be unamed.\n\nTo subset an element within the list you can use index (rspatial_indexing?). There is difference between single [] and double brackets[[]]. Can you see the differences between the below indexing?\n\na_list[1]\n\n$vec_int\n[1] 99 98\n\n\n\na_list[[1]]\n\n[1] 99 98\n\n\n\na_list[1][1]\n\n$vec_int\n[1] 99 98\n\n\n\na_list[[1]][1]\n\n[1] 99\n\n\nYou can also use the name of the element for subsetting.\n\na_list[\"vec_int\"]\n\n$vec_int\n[1] 99 98\n\n\nThe dollar-sign $ can also be used.\n\n# These three subsetting operations will give the same results\na_list$vec_int\n\n[1] 99 98\n\na_list[\"vec_int\"]\n\n$vec_int\n[1] 99 98\n\na_list[[1]]\n\n[1] 99 98\n\n\nDataframes\nDataframes are similar as lists but flattened into a rectangular form, similar as tables. The length of individual objects have to be the same.\n\nsample_data &lt;- data.frame(sample_id = c(1, 2, 3, 4),\n                          sample_name = c(\"Inflow\", \"Mid_stream\", \"Outflow\", \"River\"),\n                          measured_PFOS = c(TRUE, TRUE, TRUE, FALSE),\n                          conc_PFOS_ngL = c(99, 5, 123, NA))\n\nFactors\nSee these videos:\nhttps://www.youtube.com/watch?v=xkRBfy8_2MU\nhttps://www.youtube.com/watch?v=cspQYQLZbCo\n\n2.2.1 Object types in R\n(from https://discdown.org/rprogramming/vectors.html)\nR is an object-oriented programming language with the fundamental design principle: Everything in R is an object. In R, objects can be:\n\nVariables (e.g., a, b, result).\nFunctions (e.g., mean(), max(), sin()).\nConnection handlers.\n…\n\n\n\n2.2.2 Operators in R\nThe different comparison operators will be handy for various data analysis:\nSee: https://www.w3schools.com/r/r_operators.asp\nComparison operators\n\n\n\nOperator\nName\n\n\n\n\n==\nequal to\n\n\n!=\nnot equal to\n\n\n=&gt;\nequal or greater than\n\n\n=&lt;\nequal or less than\n\n\n&gt;\ngreater than\n\n\n&lt;\nless than\n\n\n\nArithmetic Operators\n\n\n\nOperator\nName\nExample\n\n\n\n\n+\nAddition\nx + y\n\n\n-\nSubtraction\nx - y\n\n\n*\nMultiplication\nx * y\n\n\n/\nDivision\nx / y\n\n\n^\nExponent\nx ^ y\n\n\n%%\nModulus (Remainder from division)\n10 %% 5\n\n\n%/%\nInteger Division\nx%/%y\n\n\n\nLogical Operators\n\n\n\n\n\n\n\nOperator\nDescription\n\n\n\n\n&\nElement-wise Logical AND operator. It returns TRUE if both elements are TRUE\n\n\n&&\nLogical AND operator - Returns TRUE if both statements are TRUE\n\n\n|\nElementwise- Logical OR operator. It returns TRUE if one of the statement is TRUE\n\n\n||\nLogical OR operator. It returns TRUE if one of the statement is TRUE.\n\n\n!|\nLogical NOT - returns FALSE if statement is TRUE\n\n\n\nOther useful operators\n\n\n\n\n\n\n\n\nOperator\nDescription\nExample\n\n\n\n\n:\nCreates a series of numbers in a sequence\n1:10 (creates a sequence from 1 to 10)\n\n\n%in%\nFind out if an element belongs to a vector\n2%in%1:10 (check if 2 is found in the vector 1:10, evaluates to TRUE )\n\n\n%*%\nMatrix Multiplication\nm &lt;- matrix(1:8, nrow=2); 2*m (will multiply every element with 2)\n\n\n\n\n\n2.2.3 Loading or importing data files\nSee: https://r-graphics.org/loading-a-delimited-text-data-file, and https://r-graphics.org/loading-data-from-an-excel-file\nWe will use a dataset in excel format from a study on PFAS levels in insects around a pond in Kumla in Sweden for our data analysis. You can find the dataset here: https://github.com/WBS-TW/Course_R_for_environ_chem_data_analysis/tree/master/data\n\nPFAS_insects &lt;- readxl::read_excel(\"data/Statistics_Kumla_20200408.xlsx\", \n    sheet = \"Overview\")\n\n\n\n2.2.4 Base R plots\nBase R plots are those functions that come with the R version. Additional packages that are easier to handle and have more advanced features will be demonstrated later.\nScatter plot: plot()\n\n# http://www.sthda.com/english/wiki/scatter-plots-r-base-graphs\n\nplot(x = PFAS_insects$PFOA, y = PFAS_insects$PFOS, main = \"PFOA vs PFOS concentrations\",\n     xlab = \"PFOA concentrations (ng/L)\",\n     ylab = \"PFOS concentrations (ng/L\",\n     pch = 19) # choosing symbol for points in a graph (see ?pch for number/symbol) \n\n# We can add a regression line into the same graph\nabline(lm(PFAS_insects$PFOS ~ PFAS_insects$PFOA, data = PFAS_insects), col = \"blue\", lwd = 3) # lwd is the line width\n\n# as well as a loess fit\nlines(lowess(PFAS_insects$PFOA, PFAS_insects$PFOS), col = \"red\", lwd = 3)\n\n\n\n# to clear the graphics from the Plots pane, use graphics.off() in the script or dev.off() in the console\n\nBar plots: barplot()\n\ngroupsPFOS &lt;- PFAS_insects[, c(\"Group\", \"PFOS\")] # subset two variables from the dataframe\ngroupsPFOS$Group &lt;- as.factor(groupsPFOS$Group)\nbarplot(height = PFAS_insects$PFOS)\n\n\n\n\nBox plots: boxplot()\n\n# Box plot of one variable\nboxplot(PFAS_insects$PFBS)"
  },
  {
    "objectID": "2_Conditions_Loops.html#for-loops",
    "href": "2_Conditions_Loops.html#for-loops",
    "title": "3  Conditional statements",
    "section": "3.1 For loops",
    "text": "3.1 For loops\nSee: https://www.dataquest.io/blog/for-loop-in-r/\nWe can use for loops to iterate or repeat same operation\nExample:\n\n# Create an empty character vector\nsample_PFOS_info &lt;- character()\n\n# iteratively fill the empty vector using a for loop and paste text with different cells at the i:th position of each selected column\nfor (i in 1:length(PFAS_insects$ID)) {\n  sample_PFOS_info[i] &lt;- paste(\"This sample: \", \n              PFAS_insects$ID[i], \n              \" has PFOS concentration of\", \n              round(PFAS_insects$PFOS[i],2 )\n  )\n}\n\nExample:\nWe might want to create separate vectors that include PFOS concentrations for each sample group. We use a for loop to find samples and combine samples in separate vectors that are from the same sample group (water, sediment, earthworms, emerging aquatic insects, aquatic insect larvae, terrestrial consumers).\n\nPFOS_water &lt;- as.numeric()\nPFOS_sediment &lt;- as.numeric()\nPFOS_earthworms &lt;- as.numeric()\nPFOS_emerg_aq_ins &lt;- as.numeric()\nPFOS_aq_inslarv &lt;- as.numeric()\nPFOS_terr_invcons &lt;- as.numeric()\n\nfor (i in 1:length(PFAS_insects$Group)){\n\nif(PFAS_insects$Group[i] == \"Water\"){\n  PFOS_water[i] &lt;- PFAS_insects$PFOS[i]\n} else if (PFAS_insects$Group[i] == \"Sediment\") {\n  PFOS_sediment[i] &lt;- PFAS_insects$PFOS[i]\n} else if (PFAS_insects$Group[i] == \"Earthworms\") {\n  PFOS_earthworms[i] &lt;- PFAS_insects$PFOS[i]\n} else if (PFAS_insects$Group[i] == \"Emergent aquatic insects\") {\n  PFOS_emerg_aq_ins[i] &lt;- PFAS_insects$PFOS[i]\n} else if (PFAS_insects$Group[i] == \"Aquatic insect larvae\") {\n  PFOS_aq_inslarv[i] &lt;- PFAS_insects$PFOS[i]\n} else if (PFAS_insects$Group[i] == \"Terrestrial invertebrate consumers\") {\n  PFOS_terr_invcons[i] &lt;- PFAS_insects$PFOS[i]\n}\n}\n\nThe output of some vectors\n\nstr(PFOS_water)\n\n num [1:9] 228.588 140.046 0.149 1044.649 442.203 ...\n\nstr(PFOS_earthworms)\n\n num [1:14] NA NA NA NA NA NA NA NA NA NA ...\n\nstr(PFOS_aq_inslarv)\n\n num [1:65] NA NA NA NA NA NA NA NA NA NA ...\n\n\nHowever, we can see that the [i]index is the same for all objects which means that once R finds the statement that evaluates to TRUE, then it will paste the value in the i:th element in the output object. Therefore any other values that evaluates to FALSE will get NA values.\nTo remove NA values from each output vector.\n\nPFOS_water &lt;- as.numeric()\nPFOS_sediment &lt;- as.numeric()\nPFOS_earthworms &lt;- as.numeric()\nPFOS_emerg_aq_ins &lt;- as.numeric()\nPFOS_aq_inslarv &lt;- as.numeric()\nPFOS_terr_invcons &lt;- as.numeric()\n\nfor (i in 1:length(PFAS_insects$Group)){\n  if(PFAS_insects$Group[i] == \"Water\"){\n    j &lt;- length(PFOS_water)+1\n    PFOS_water[j] &lt;- PFAS_insects$PFOS[i]\n} else if (PFAS_insects$Group[i] == \"Sediment\") {\n  k &lt;- length(PFOS_sediment)+1\n  PFOS_sediment[k] &lt;- PFAS_insects$PFOS[i]\n} else if (PFAS_insects$Group[i] == \"Earthworms\") {\n  l &lt;- length(PFOS_earthworms)+1\n  PFOS_earthworms[l] &lt;- PFAS_insects$PFOS[i]\n} else if (PFAS_insects$Group[i] == \"Emergent aquatic insects\") {\n  m &lt;- length(PFOS_emerg_aq_ins)+1\n  PFOS_emerg_aq_ins[m] &lt;- PFAS_insects$PFOS[i]\n} else if (PFAS_insects$Group[i] == \"Aquatic insect larvae\") {\n  n &lt;- length(PFOS_aq_inslarv)+1\n  PFOS_aq_inslarv[n] &lt;- PFAS_insects$PFOS[i]\n} else if (PFAS_insects$Group[i] == \"Terrestrial invertebrate consumers\") {\n  o &lt;- length(PFOS_terr_invcons)+1\n  PFOS_terr_invcons[o] &lt;- PFAS_insects$PFOS[i]\n}\n}\n\n\nstr(PFOS_water)\n\n num [1:9] 228.588 140.046 0.149 1044.649 442.203 ...\n\nstr(PFOS_earthworms)\n\n num [1:3] 976.1 558.8 29.6\n\nstr(PFOS_aq_inslarv)\n\n num [1:16] 486 448 547 334 311 ...\n\n\nAs you can see, the script becomes long and repetitive, and therefore easy to make mistakes. There are easier ways to get the same results. Can you think of a more efficient script?\n\nfor (i in 1:3) {\n  for(j in 1:2) {\n    print(letters[j])\n  }\n  print(i)\n  }\n\n[1] \"a\"\n[1] \"b\"\n[1] 1\n[1] \"a\"\n[1] \"b\"\n[1] 2\n[1] \"a\"\n[1] \"b\"\n[1] 3"
  },
  {
    "objectID": "3_Functions.html#using-functions.",
    "href": "3_Functions.html#using-functions.",
    "title": "4  Functions",
    "section": "4.1 Using functions.",
    "text": "4.1 Using functions.\nIt is recommended to use the ? to see the help page for the function, and see the different arguments within the function. For example, `?round()` will show both the help text for the round function as well as similar functions that shares a same help text. We can also see that the usage is round(x, digits = 0), where x is a single value and digits has a default value of 0. You can change these arguments.\n\nround(x = 98.9893323)\n\n[1] 99\n\n\n\nround(x = 98.9893323, digits = 2)\n\n[1] 98.99\n\n\nYou can also leave out the argument names in the function. The order of the arguments should be the same as in the function help text. Below will give the same output as the above.\n\nround(98.9893323, 2)\n\n[1] 98.99\n\n\n\n4.1.1 Useful functions in base R\napply()\n?apply will show the help text:\nApply Functions Over Array Margins Description Returns a vector or array or list of values obtained by applying a function to margins of an array or matrix.\nUsage\napply(X, MARGIN, FUN, …, simplify = TRUE)\nArguments\nX an array, including a matrix.\nMARGIN - a vector giving the subscripts which the function will be applied over. E.g., for a matrix 1 indicates rows, 2 indicates columns, c(1, 2) indicates rows and columns. Where X has named dimnames, it can be a character vector selecting dimension names.\nFUN - the function to be applied: see ‘Details’. In the case of functions like +, %*%, etc., the function name must be backquoted or quoted.\n… - optional arguments to FUN.\nsimplify - a logical indicating whether results should be simplified if possible.\nDetails… Value…\nYou can specify the function with the names of the arguments:\n\napply(PFAS_insects[, 13:14], 2, median)\n\n      PFBA      PFPeA \n0.21829513 0.06666667 \n\n\nThis function will apply the `median` function across multiple columns (or rows) within a specified matrix or dataframe. In this case, we have filtered out the PFBA and PFPeA compounds from the PFAS_insects dataframe while keeping all rows (samples), and specified MARGIN = 2 for columns, and therefore calculated the median of these two analytes separately. You dont need to add the () for the function in the FUN argument."
  },
  {
    "objectID": "3_Functions.html#writing-your-own-functions",
    "href": "3_Functions.html#writing-your-own-functions",
    "title": "4  Functions",
    "section": "4.2 Writing your own functions",
    "text": "4.2 Writing your own functions\nWe can write functions by using the below structure:\n\nname_of_function &lt;- function(argument1, argument2,...) {\n  YOUR CUSTOM SCRIPT\n  return(OUTPUT)\n}\n\nAn example:\nWhen you name the functions, it is good to use a verb to describe what the function does.\n\nadd_my_values &lt;- function(values) {\n  \n  for (i in seq_along(values)) {\n    i+1\n    \n  }\n}\n\nHere is another example to calculate the standard error (se) by using the standard deviation function sd:\n\\[\nse = \\frac{\\sigma}{\\sqrt{n}}\n\\]\n(check this link on how to write Latex codes for mathematical expressions: https://www.malinc.se/math/latex/basiccodeen.php)\n\nstderror &lt;- function(x) {\n  se &lt;- sd(x, na.rm=TRUE)/sqrt(length(x[!is.na(x)]))  # the script\n  se # the output\n}\n\nThe input argument x is a numeric vector.\n\nsd(c(1,2,3))\n\n[1] 1\n\nstderror(c(1,2,3))\n\n[1] 0.5773503\n\n\nApply this function to the PFAS dataset\n\nsd(PFAS_insects$PFOS)\n\n[1] 460.6185\n\nstderror(PFAS_insects$PFOS)\n\n[1] 44.32303"
  },
  {
    "objectID": "4_Tidyverse.html#dplyr",
    "href": "4_Tidyverse.html#dplyr",
    "title": "5  Tidyverse",
    "section": "5.1 dplyr",
    "text": "5.1 dplyr\nThe pipe operator %&gt;% (or |&gt;)\nSee: https://r4ds.hadley.nz/data-transform\nhttps://r4ds.hadley.nz/data-transform#sec-the-pipe\nTo change the shortcut Ctrl+shift+M to use the new pipe, go to “Global options” -&gt; “Code” -&gt; “Use native pipe operator..”\n\n5.1.1 Helpful dplyr functions\nhttps://dplyr.tidyverse.org/index.html\nselect and filter\n\n PFAS_insects |&gt;  \n   select(PFOS) |&gt; \n   filter(PFOS &gt; 100)\n\n# A tibble: 65 × 1\n    PFOS\n   &lt;dbl&gt;\n 1  229.\n 2  140.\n 3 1045.\n 4  442.\n 5  540.\n 6  223.\n 7  976.\n 8  559.\n 9  830.\n10  162.\n# ℹ 55 more rows\n\n\nHere, we first select only the PFOS variable and then filter to only include all PFOS rows that have a value above 100.\nmutate\n\nPFAS_insects |&gt; \n  mutate(ratioPFOS_PFOA = PFOS/PFOA) |&gt; \n  select(ID, PFOS, PFOA, ratioPFOS_PFOA, everything()) |&gt; \n  glimpse()\n\nRows: 108\nColumns: 48\n$ ID                  &lt;chr&gt; \"W1\", \"W2\", \"W3\", \"W4\", \"W5\", \"W6\", \"W7\", \"W8\", \"W…\n$ PFOS                &lt;dbl&gt; 228.5876694, 140.0461141, 0.1487718, 1044.6492478,…\n$ PFOA                &lt;dbl&gt; 21.69212645, 8.37805605, 0.21929477, 53.87371338, …\n$ ratioPFOS_PFOA      &lt;dbl&gt; 10.5378175, 16.7158244, 0.6784101, 19.3907043, 36.…\n$ `Full ID`           &lt;chr&gt; \"K1 W S17\", \"KS W S17\", \"KRef W S17\", \"K1 W F17\", …\n$ `Sampling site`     &lt;chr&gt; \"K1\", \"KS\", \"KRef\", \"K1\", \"KS\", \"KRef\", \"K1\", \"KS\"…\n$ Number              &lt;dbl&gt; 1, 1, 1, 1, 1, 1, 1, 1, 1, 2, 2, 6, 6, 6, 4, 4, 4,…\n$ Group               &lt;chr&gt; \"Water\", \"Water\", \"Water\", \"Water\", \"Water\", \"Wate…\n$ Group_Family        &lt;chr&gt; \"Water 1_S17\", \"Water S_S17\", \"Water Ref_S17\", \"Wa…\n$ `g ww`              &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, 226.2650, 265.…\n$ `g dw`              &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, 166.1500, 180.…\n$ Quantity            &lt;chr&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, \"&gt;50?\"…\n$ `Extraction (mL_g)` &lt;dbl&gt; 509.3000, 503.1000, 504.8000, 505.2000, 502.9000, …\n$ Year                &lt;dbl&gt; 2017, 2017, 2017, 2017, 2017, 2017, 2018, 2018, 20…\n$ Unit                &lt;chr&gt; \"ng L-1\", \"ng L-1\", \"ng L-1\", \"ng L-1\", \"ng L-1\", …\n$ PFBA                &lt;dbl&gt; 27.43981936, 9.58079905, 0.03025223, 36.65399842, …\n$ PFPeA               &lt;dbl&gt; 35.52523071, 22.47445836, 0.04000000, 81.99861441,…\n$ PFBS                &lt;dbl&gt; 81.77518162, 39.52752932, 0.11291601, 129.03939034…\n$ PFHxA               &lt;dbl&gt; 56.52955036, 26.18425760, 0.22167195, 131.18784640…\n$ PFHpA               &lt;dbl&gt; 25.845474180, 14.325581395, 0.229001585, 56.980997…\n$ PFPeS80             &lt;dbl&gt; 6.390536030, 3.072351421, 0.040000000, 24.10866983…\n$ PFHxS80             &lt;dbl&gt; 58.36147654, 27.92029418, 0.11945325, 211.65459224…\n$ PFHpS80             &lt;dbl&gt; 4.59866483, 2.64738621, 0.04000000, 25.81888361, 5…\n$ PFNA                &lt;dbl&gt; 7.66129982, 3.07553170, 0.04000000, 11.20051465, 6…\n$ PFOSA               &lt;dbl&gt; 5.345965050, 0.485986881, 0.001421537, 13.07422802…\n$ PFDA                &lt;dbl&gt; 2.01335166, 0.42238124, 0.04000000, 4.60768013, 1.…\n$ PFUnDA              &lt;dbl&gt; 0.77694875, 0.12482608, 0.04000000, 2.05740301, 0.…\n$ PFNS80              &lt;dbl&gt; 0.25152170, 0.14748559, 0.04000000, 0.97604909, 0.…\n$ PFDS80              &lt;dbl&gt; 0.04000000, 0.04000000, 0.04000000, 0.17537609, 0.…\n$ PFDoDA              &lt;dbl&gt; 0.10799136, 0.04000000, 0.04000000, 0.34065717, 0.…\n$ PFTrDA              &lt;dbl&gt; 0.04000000, 0.04000000, 0.04000000, 0.04000000, 0.…\n$ PFDoDS80            &lt;dbl&gt; 0.04000000, 0.04000000, 0.04000000, 0.04000000, 0.…\n$ `6_2_FTSA`          &lt;dbl&gt; 11.9654428, 1.8833234, 0.0400000, 13.1551861, 9.13…\n$ `8_2_FTSA`          &lt;dbl&gt; 1.89083055, 0.16974757, 0.04000000, 2.64806017, 0.…\n$ `10_2 FTSA`         &lt;dbl&gt; 0.31710190, 0.04000000, 0.04000000, 0.77197150, 0.…\n$ `3/4/5-PFOS80/98.9` &lt;dbl&gt; 52.09326527, 34.14410654, 0.04000000, 260.75296912…\n$ `6/2-PFOS169/80`    &lt;dbl&gt; 37.18869036, 22.57980521, 0.04000000, 186.81631037…\n$ `1-PFOS 419/169`    &lt;dbl&gt; 9.94718241, 6.85311071, 0.04000000, 52.70704671, 2…\n$ `L-PFOS 99/169`     &lt;dbl&gt; 233.8221088, 137.8682171, 0.1561014, 1014.2911718,…\n$ `L-PFHxS80`         &lt;dbl&gt; 55.95817789, 26.48558935, 0.11489699, 197.49920823…\n$ `1-PFHxS`           &lt;dbl&gt; 0.67956018, 0.45875571, 0.04000000, 2.70744260, 0.…\n$ `4/2-PFHxS`         &lt;dbl&gt; 7.68270175, 3.76446035, 0.04000000, 28.67082344, 4…\n$ `3-PFHxS`           &lt;dbl&gt; 2.47378755, 1.15543629, 0.04000000, 9.22090261, 1.…\n$ sum_PFOS            &lt;dbl&gt; 327.8168074, 203.6231366, 0.2687718, 1544.9255740,…\n$ sum_brPFOS          &lt;dbl&gt; 99.2291380, 63.5770225, 0.1200000, 500.2763262, 21…\n$ sum_PFHxS           &lt;dbl&gt; 69.1975260, 33.2989465, 0.2394532, 252.2537609, 41…\n$ sum_brPFHxS         &lt;dbl&gt; 10.8360495, 5.3786524, 0.1200000, 40.5991686, 6.45…\n$ sum_21PFAS          &lt;dbl&gt; 687.261371, 369.621785, 1.882783, 2385.928575, 880…\n\n\nMutate creates a new variable by some conditions such as dividing the PFOS with PFOA. We can thereafter sort how the columns are arranged by select ID, PFOS, PFOA, ratioPFOS_PFOA in this order. The everything()function will select all other columns. This way, we have made a new order of the columns. The glimpse() function is similar as str() but gives a better overview of the data frame.\nUsing mutate with case_when helper function\n\nPFAS_insects |&gt; \n  mutate(ratioPFOS_PFOA = case_when(PFOS/PFOA &gt; 10 ~ \"HighPFOS\",\n                                    PFOS/PFOA &lt;= 10 & PFOS/PFOA &gt; 5 ~ \"MediumPFOS\",\n                                    PFOS/PFOA  &lt;= 5 ~ \"LowPFOS\")) |&gt; \n  select(ID, ratioPFOS_PFOA) |&gt; \n  glimpse()\n\nRows: 108\nColumns: 2\n$ ID             &lt;chr&gt; \"W1\", \"W2\", \"W3\", \"W4\", \"W5\", \"W6\", \"W7\", \"W8\", \"W9\", \"…\n$ ratioPFOS_PFOA &lt;chr&gt; \"HighPFOS\", \"HighPFOS\", \"LowPFOS\", \"HighPFOS\", \"HighPFO…\n\n\narrange\n\nPFAS_insects |&gt; \n  #arrange(desc(PFOS)) |&gt;\n  arrange(PFOS) |&gt;\n  select(ID, PFOS, everything()) |&gt; \n  glimpse()\n\nRows: 108\nColumns: 47\n$ ID                  &lt;chr&gt; \"W3\", \"P36\", \"W9\", \"S3\", \"SW10\", \"D10\", \"W6\", \"L13…\n$ PFOS                &lt;dbl&gt; 0.1487718, 0.4887884, 0.5090367, 0.5269612, 0.5269…\n$ `Full ID`           &lt;chr&gt; \"KRef W S17\", \"Kref Chi\", \"KRef W S18\", \"KRefS\", \"…\n$ `Sampling site`     &lt;chr&gt; \"KRef\", \"KRef\", \"KRef\", \"KRef\", \"KRef\", \"KRef\", \"K…\n$ Number              &lt;dbl&gt; 1, 5, 1, 2, 4, 4, 1, 3, 5, 2, 3, 4, 4, 4, 3, 3, 5,…\n$ Group               &lt;chr&gt; \"Water\", \"Terrestrial invertebrate consumers\", \"Wa…\n$ Group_Family        &lt;chr&gt; \"Water Ref_S17\", \"Lithobiomorpha\", \"Water Ref_S18\"…\n$ `g ww`              &lt;dbl&gt; NA, 0.2538, NA, 265.0800, 0.4753, 0.5937, NA, 0.60…\n$ `g dw`              &lt;dbl&gt; NA, 0.0777, NA, 180.8600, 0.2866, 0.1412, NA, 0.10…\n$ Quantity            &lt;chr&gt; NA, \"6\", NA, NA, \"426\", \"388\", NA, \"165\", \"24\", NA…\n$ `Extraction (mL_g)` &lt;dbl&gt; 504.8000, 0.5530, 503.5000, 0.5390, 0.1526, 0.1061…\n$ Year                &lt;dbl&gt; 2017, 2017, 2018, 2017, 2018, 2018, 2017, 2017, 20…\n$ Unit                &lt;chr&gt; \"ng L-1\", \"ng g-1\", \"ng L-1\", \"ng g-1\", \"ng g-1\", …\n$ PFBA                &lt;dbl&gt; 0.03025223, 0.96429560, 0.03025223, 0.32282004, 0.…\n$ PFPeA               &lt;dbl&gt; 0.04000000, 0.37956600, 0.04000000, 0.06666667, 8.…\n$ PFBS                &lt;dbl&gt; 0.11291601, 0.01699019, 0.08659384, 0.01389705, 0.…\n$ PFHxA               &lt;dbl&gt; 0.22167195, 0.06666667, 0.25878848, 0.06666667, 0.…\n$ PFHpA               &lt;dbl&gt; 0.229001585, 0.009990188, 0.186494538, 0.009072167…\n$ PFPeS80             &lt;dbl&gt; 0.040000000, 0.066666667, 0.040000000, 0.001333333…\n$ PFHxS80             &lt;dbl&gt; 0.11945325, 0.02561151, 0.13286991, 0.05092416, 0.…\n$ PFHpS80             &lt;dbl&gt; 0.040000000, 0.066666667, 0.040000000, 0.066666667…\n$ PFOA                &lt;dbl&gt; 0.21929477, 0.04596075, 0.19404171, 0.03321067, 0.…\n$ PFNA                &lt;dbl&gt; 0.04000000, 0.06666667, 0.04000000, 0.06666667, 0.…\n$ PFOSA               &lt;dbl&gt; 0.001421537, 0.066666667, 0.006752731, 0.066666667…\n$ PFDA                &lt;dbl&gt; 0.04000000, 0.06666667, 0.04000000, 0.06666667, 0.…\n$ PFUnDA              &lt;dbl&gt; 0.04000000, 0.19276673, 0.04000000, 0.02072712, 0.…\n$ PFNS80              &lt;dbl&gt; 0.04000000, 0.06666667, 0.04000000, 0.06666667, 0.…\n$ PFDS80              &lt;dbl&gt; 0.04000000, 0.06666667, 0.04000000, 0.06666667, 0.…\n$ PFDoDA              &lt;dbl&gt; 0.04000000, 0.06666667, 0.04000000, 0.06666667, 0.…\n$ PFTrDA              &lt;dbl&gt; 0.04000000, 0.06666667, 0.04000000, 0.06666667, 0.…\n$ PFDoDS80            &lt;dbl&gt; 0.04000000, 0.06666667, 0.04000000, 0.06666667, 0.…\n$ `6_2_FTSA`          &lt;dbl&gt; 0.04000000, 0.08178308, 0.04000000, 0.10336846, 0.…\n$ `8_2_FTSA`          &lt;dbl&gt; 0.04000000, 0.06666667, 0.04000000, 0.06666667, 0.…\n$ `10_2 FTSA`         &lt;dbl&gt; 0.04000000, 0.06666667, 0.04000000, 0.06666667, 0.…\n$ `3/4/5-PFOS80/98.9` &lt;dbl&gt; 0.04000000, 0.03345389, 0.13823237, 0.04474999, 0.…\n$ `6/2-PFOS169/80`    &lt;dbl&gt; 0.04000000, 0.06666667, 0.09751738, 0.06402691, 0.…\n$ `1-PFOS 419/169`    &lt;dbl&gt; 0.04000000, 0.06666667, 0.04000000, 0.06666667, 0.…\n$ `L-PFOS 99/169`     &lt;dbl&gt; 0.15610143, 0.51066908, 0.50844091, 0.57555371, 0.…\n$ `L-PFHxS80`         &lt;dbl&gt; 0.11489699, 0.01757597, 0.11519364, 0.04788187, 0.…\n$ `1-PFHxS`           &lt;dbl&gt; 0.04000000, 0.06666667, 0.04000000, 0.06666667, 0.…\n$ `4/2-PFHxS`         &lt;dbl&gt; 0.04000000, 0.06666667, 0.04000000, 0.06666667, 0.…\n$ `3-PFHxS`           &lt;dbl&gt; 0.04000000, 0.06666667, 0.04000000, 0.06666667, 0.…\n$ sum_PFOS            &lt;dbl&gt; 0.2687718, 0.6555756, 0.7847865, 0.7024048, 0.7024…\n$ sum_brPFOS          &lt;dbl&gt; 0.1200000, 0.1667872, 0.2757498, 0.1754436, 0.1754…\n$ sum_PFHxS           &lt;dbl&gt; 0.2394532, 0.2256115, 0.2528699, 0.2509242, 0.2509…\n$ sum_brPFHxS         &lt;dbl&gt; 0.1200000, 0.2000000, 0.1200000, 0.2000000, 0.2000…\n$ sum_21PFAS          &lt;dbl&gt; 1.882783, 3.439206, 2.360580, 2.324424, 11.001451,…\n\n\nHere, we arranged the dataframe by descending PFOS levels (highest first)\nWe can also group by character variables such as the Group variable and then the descending PFOS levels.\n\nPFAS_insects |&gt; \n  arrange(Group, desc(PFOS)) |&gt; \n  select(ID, Group, PFOS, everything()) |&gt; \n  glimpse()\n\nRows: 108\nColumns: 47\n$ ID                  &lt;chr&gt; \"L9\", \"L12\", \"L10\", \"L11\", \"L3\", \"L1\", \"L2\", \"L4\",…\n$ Group               &lt;chr&gt; \"Aquatic insect larvae\", \"Aquatic insect larvae\", …\n$ PFOS                &lt;dbl&gt; 1990.9753846, 1651.5997401, 1148.0231884, 747.8346…\n$ `Full ID`           &lt;chr&gt; \"K1L Zygo\", \"K1L Ani elongated\", \"K1L Ani small\", …\n$ `Sampling site`     &lt;chr&gt; \"K1\", \"K1\", \"K1\", \"K1\", \"KS\", \"KS\", \"KS\", \"KS\", \"K…\n$ Number              &lt;dbl&gt; 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 6,…\n$ Group_Family        &lt;chr&gt; \"Odonata Zygoptera\", \"Odonata Anisoptera\", \"Odonat…\n$ `g ww`              &lt;dbl&gt; 0.3027, 0.9847, 0.1802, 1.7639, 0.1880, 0.1171, 0.…\n$ `g dw`              &lt;dbl&gt; 0.0771, 0.3629, 0.0549, 0.2526, 0.0454, 0.0332, 0.…\n$ Quantity            &lt;chr&gt; \"69\", \"4\", \"8\", \"3\", \"30\", \"59\", \"58\", \"9\", \"2\", \"…\n$ `Extraction (mL_g)` &lt;dbl&gt; 0.0650, 0.1539, 0.0345, 0.1379, 0.0307, 0.0264, 0.…\n$ Year                &lt;dbl&gt; 2017, 2017, 2017, 2017, 2017, 2017, 2017, 2017, 20…\n$ Unit                &lt;chr&gt; \"ng g-1\", \"ng g-1\", \"ng g-1\", \"ng g-1\", \"ng g-1\", …\n$ PFBA                &lt;dbl&gt; 6.56000000, 0.05491540, 0.05491540, 0.05491540, 0.…\n$ PFPeA               &lt;dbl&gt; 10.65076923, 3.83040936, 6.79710145, 7.38578680, 2…\n$ PFBS                &lt;dbl&gt; 1.69076923, 0.41585445, 2.15652174, 1.01812908, 0.…\n$ PFHxA               &lt;dbl&gt; 3.56615385, 2.00649773, 2.40579710, 2.38578680, 2.…\n$ PFHpA               &lt;dbl&gt; 0.706153846, 0.447693307, 0.562318841, 0.021475469…\n$ PFPeS80             &lt;dbl&gt; 1.02307692, 0.28005198, 1.25217391, 0.61131255, 0.…\n$ PFHxS80             &lt;dbl&gt; 41.52153846, 24.00000000, 29.51884058, 26.84626541…\n$ PFHpS80             &lt;dbl&gt; 9.178461538, 9.007797271, 6.121739130, 4.828861494…\n$ PFOA                &lt;dbl&gt; 3.1492308, 1.2586095, 4.2637681, 6.6403191, 1.4136…\n$ PFNA                &lt;dbl&gt; 5.35384615, 5.37037037, 4.86666667, 3.82813633, 2.…\n$ PFOSA               &lt;dbl&gt; 51.1138462, 80.8966862, 89.7362319, 66.1696882, 32…\n$ PFDA                &lt;dbl&gt; 11.44307692, 9.88369071, 9.11884058, 5.81290790, 3…\n$ PFUnDA              &lt;dbl&gt; 15.14000000, 8.40025991, 21.47826087, 12.39158811,…\n$ PFNS80              &lt;dbl&gt; 6.15692308, 4.76738142, 4.78260870, 3.39013778, 4.…\n$ PFDS80              &lt;dbl&gt; 4.93384615, 3.13255361, 5.85507246, 3.55765047, 2.…\n$ PFDoDA              &lt;dbl&gt; 9.71846154, 5.00714750, 20.84057971, 9.60261059, 1…\n$ PFTrDA              &lt;dbl&gt; 3.42153846, 2.87004548, 4.55652174, 2.36475707, 0.…\n$ PFDoDS80            &lt;dbl&gt; 1.97384615, 2.08966862, 3.44057971, 2.23205221, 0.…\n$ `6_2_FTSA`          &lt;dbl&gt; 53.76153846, 13.63157895, 48.16231884, 32.00435098…\n$ `8_2_FTSA`          &lt;dbl&gt; 117.31846154, 63.60623782, 105.01449275, 70.604786…\n$ `10_2 FTSA`         &lt;dbl&gt; 10.23384615, 2.27940221, 10.64637681, 8.78390138, …\n$ `3/4/5-PFOS80/98.9` &lt;dbl&gt; 124.37538462, 180.13840156, 46.17681159, 0.0666666…\n$ `6/2-PFOS169/80`    &lt;dbl&gt; 124.19076923, 165.70240416, 41.67826087, 31.430021…\n$ `1-PFOS 419/169`    &lt;dbl&gt; 32.37230769, 48.41520468, 14.75942029, 8.87527194,…\n$ `L-PFOS 99/169`     &lt;dbl&gt; 2.103365e+03, 1.766962e+03, 1.237420e+03, 7.963133…\n$ `L-PFHxS80`         &lt;dbl&gt; 39.40153846, 22.67446394, 28.48985507, 25.20739666…\n$ `1-PFHxS`           &lt;dbl&gt; 0.06666667, 0.06666667, 0.06666667, 0.06666667, 0.…\n$ `4/2-PFHxS`         &lt;dbl&gt; 1.34153846, 0.72709552, 1.26086957, 0.99492386, 0.…\n$ `3-PFHxS`           &lt;dbl&gt; 0.50769231, 0.46328785, 0.52753623, 0.55039884, 0.…\n$ sum_PFOS            &lt;dbl&gt; 2271.913846, 2045.855750, 1250.637681, 788.206623,…\n$ sum_brPFOS          &lt;dbl&gt; 280.9384615, 394.2560104, 102.6144928, 40.3719604,…\n$ sum_PFHxS           &lt;dbl&gt; 43.4374359, 25.2570500, 31.3739130, 28.4582548, 18…\n$ sum_brPFHxS         &lt;dbl&gt; 1.9158974, 1.2570500, 1.8550725, 1.6119894, 0.6888…\n$ sum_21PFAS          &lt;dbl&gt; 2642.445128, 2290.349652, 1634.124481, 1060.354032…\n\n\nThe Group variable will then be arranged alphabetically. Using the desc() helper function will reverse the alphabetical order.\nsummarise and reframe\nsummariseis helpful to provide some summary statistics for variables.\n\nPFAS_insects |&gt;\n  summarise(mean = mean(PFOS), median = median(PFOS), n = n())\n\n# A tibble: 1 × 3\n   mean median     n\n  &lt;dbl&gt;  &lt;dbl&gt; &lt;int&gt;\n1  322.   160.   108\n\n\nHere we summarise the mean and median and number (using the n() function) of data points for PFOS.\nWe can also calculate the summary statistics of PFOS levels for each Group.\n\nPFAS_insects |&gt; \n  group_by(Group) |&gt; \n  summarise(mean = mean(PFOS), median = median(PFOS), n = n())\n\n# A tibble: 6 × 4\n  Group                               mean median     n\n  &lt;chr&gt;                              &lt;dbl&gt;  &lt;dbl&gt; &lt;int&gt;\n1 Aquatic insect larvae              517.  322.      16\n2 Earthworms                         521.  559.       3\n3 Emergent aquatic insects           226.   97.8     42\n4 Sediment                            75.0   1.34     3\n5 Terrestrial invertebrate consumers 363.  236.      35\n6 Water                              272.  140.       9\n\n\nBeware that grouping is still applied in objects that have been saved which has been applied with group_by().\n\nPFAS_insects_grouped &lt;- PFAS_insects |&gt;\n  group_by(Group)\n\nPFAS_insects_grouped |&gt; summarise(mean = mean(PFOS), median = median(PFOS), n = n())\n\n# A tibble: 6 × 4\n  Group                               mean median     n\n  &lt;chr&gt;                              &lt;dbl&gt;  &lt;dbl&gt; &lt;int&gt;\n1 Aquatic insect larvae              517.  322.      16\n2 Earthworms                         521.  559.       3\n3 Emergent aquatic insects           226.   97.8     42\n4 Sediment                            75.0   1.34     3\n5 Terrestrial invertebrate consumers 363.  236.      35\n6 Water                              272.  140.       9\n\n\nTo remove the grouping, use ungroup() before performing additional operations.\n\nPFAS_insects_grouped |&gt; \n  ungroup() |&gt; \n  summarise(mean = mean(PFOS), median = median(PFOS), n = n())\n\n# A tibble: 1 × 3\n   mean median     n\n  &lt;dbl&gt;  &lt;dbl&gt; &lt;int&gt;\n1  322.   160.   108\n\n\nhttps://dplyr.tidyverse.org/reference/reframe.html: While summarise() requires that each argument returns a single value, and mutate() requires that each argument returns the same number of rows as the input, reframe() is a more general workhorse with no requirements on the number of rows returned per group\n\n#&gt;  When switching from `summarise()` to `reframe()`, remember that `reframe()` always returns an ungrouped data frame and adjust accordingly.\n\nPFAS_insects |&gt; \n  group_by(Group) |&gt; \n  reframe(qs = quantile(PFOS, c(0.25, 0.75)), prob = c(0.25, 0.75))\n\n# A tibble: 12 × 3\n   Group                                   qs  prob\n   &lt;chr&gt;                                &lt;dbl&gt; &lt;dbl&gt;\n 1 Aquatic insect larvae              142.     0.25\n 2 Aquatic insect larvae              597.     0.75\n 3 Earthworms                         294.     0.25\n 4 Earthworms                         767.     0.75\n 5 Emergent aquatic insects            14.2    0.25\n 6 Emergent aquatic insects           273.     0.75\n 7 Sediment                             0.931  0.25\n 8 Sediment                           112.     0.75\n 9 Terrestrial invertebrate consumers  58.7    0.25\n10 Terrestrial invertebrate consumers 439.     0.75\n11 Water                                0.839  0.25\n12 Water                              442.     0.75\n\n\nacross\nhttps://dplyr.tidyverse.org/reference/across.html: across() makes it easy to apply the same transformation to multiple columns, allowing you to use select() semantics inside in “data-masking” functions like summarise() and mutate()\n\nPFAS_insects |&gt; \n  mutate(across(where(is.numeric), round)) |&gt; \n  glimpse()\n\nRows: 108\nColumns: 47\n$ ID                  &lt;chr&gt; \"W1\", \"W2\", \"W3\", \"W4\", \"W5\", \"W6\", \"W7\", \"W8\", \"W…\n$ `Full ID`           &lt;chr&gt; \"K1 W S17\", \"KS W S17\", \"KRef W S17\", \"K1 W F17\", …\n$ `Sampling site`     &lt;chr&gt; \"K1\", \"KS\", \"KRef\", \"K1\", \"KS\", \"KRef\", \"K1\", \"KS\"…\n$ Number              &lt;dbl&gt; 1, 1, 1, 1, 1, 1, 1, 1, 1, 2, 2, 6, 6, 6, 4, 4, 4,…\n$ Group               &lt;chr&gt; \"Water\", \"Water\", \"Water\", \"Water\", \"Water\", \"Wate…\n$ Group_Family        &lt;chr&gt; \"Water 1_S17\", \"Water S_S17\", \"Water Ref_S17\", \"Wa…\n$ `g ww`              &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, 226, 265, 13, …\n$ `g dw`              &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, 166, 181, 3, 1…\n$ Quantity            &lt;chr&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, \"&gt;50?\"…\n$ `Extraction (mL_g)` &lt;dbl&gt; 509, 503, 505, 505, 503, 509, 513, 503, 504, 1, 1,…\n$ Year                &lt;dbl&gt; 2017, 2017, 2017, 2017, 2017, 2017, 2018, 2018, 20…\n$ Unit                &lt;chr&gt; \"ng L-1\", \"ng L-1\", \"ng L-1\", \"ng L-1\", \"ng L-1\", …\n$ PFBA                &lt;dbl&gt; 27, 10, 0, 37, 16, 0, 33, 7, 0, 0, 0, 18, 0, 0, 0,…\n$ PFPeA               &lt;dbl&gt; 36, 22, 0, 82, 31, 0, 53, 10, 0, 0, 0, 11, 24, 15,…\n$ PFBS                &lt;dbl&gt; 82, 40, 0, 129, 43, 0, 175, 24, 0, 0, 0, 2, 1, 1, …\n$ PFHxA               &lt;dbl&gt; 57, 26, 0, 131, 38, 0, 85, 12, 0, 1, 0, 7, 2, 2, 0…\n$ PFHpA               &lt;dbl&gt; 26, 14, 0, 57, 15, 0, 41, 5, 0, 0, 0, 0, 0, 0, 2, …\n$ PFPeS80             &lt;dbl&gt; 6, 3, 0, 24, 4, 0, 16, 2, 0, 0, 0, 20, 21, 4, 1, 0…\n$ PFHxS80             &lt;dbl&gt; 58, 28, 0, 212, 35, 0, 138, 17, 0, 4, 0, 82, 51, 6…\n$ PFHpS80             &lt;dbl&gt; 5, 3, 0, 26, 6, 0, 13, 1, 0, 1, 0, 3, 3, 0, 6, 1, …\n$ PFOA                &lt;dbl&gt; 22, 8, 0, 54, 12, 0, 32, 4, 0, 1, 0, 4, 2, 5, 2, 1…\n$ PFNA                &lt;dbl&gt; 8, 3, 0, 11, 6, 0, 7, 1, 0, 0, 0, 2, 1, 3, 1, 1, 1…\n$ PFOSA               &lt;dbl&gt; 5, 0, 0, 13, 3, 0, 6, 0, 0, 3, 0, 2, 2, 0, 10, 5, …\n$ PFOS                &lt;dbl&gt; 229, 140, 0, 1045, 442, 1, 540, 55, 1, 223, 1, 976…\n$ PFDA                &lt;dbl&gt; 2, 0, 0, 5, 2, 0, 3, 0, 0, 0, 0, 3, 2, 1, 2, 3, 1,…\n$ PFUnDA              &lt;dbl&gt; 1, 0, 0, 2, 0, 0, 1, 0, 0, 0, 0, 3, 2, 2, 3, 2, 1,…\n$ PFNS80              &lt;dbl&gt; 0, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 4, 2, 0, 3, 1, 0,…\n$ PFDS80              &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 5, 1, 0, 3, 1, 0,…\n$ PFDoDA              &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 6, 3, 2, 3, 3, 1,…\n$ PFTrDA              &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 14, 4, 4, 1, 1, 0…\n$ PFDoDS80            &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 13, 0, 0, 1, 0, 0…\n$ `6_2_FTSA`          &lt;dbl&gt; 12, 2, 0, 13, 9, 0, 20, 5, 0, 0, 0, 4, 3, 1, 40, 5…\n$ `8_2_FTSA`          &lt;dbl&gt; 2, 0, 0, 3, 1, 0, 11, 1, 0, 0, 0, 3, 11, 0, 42, 11…\n$ `10_2 FTSA`         &lt;dbl&gt; 0, 0, 0, 1, 0, 0, 1, 0, 0, 0, 0, 5, 2, 0, 6, 2, 1,…\n$ `3/4/5-PFOS80/98.9` &lt;dbl&gt; 52, 34, 0, 261, 110, 0, 136, 13, 0, 22, 0, 3, 2, 0…\n$ `6/2-PFOS169/80`    &lt;dbl&gt; 37, 23, 0, 187, 76, 0, 94, 9, 0, 18, 0, 9, 7, 1, 4…\n$ `1-PFOS 419/169`    &lt;dbl&gt; 10, 7, 0, 53, 25, 0, 27, 3, 0, 7, 0, 2, 3, 0, 10, …\n$ `L-PFOS 99/169`     &lt;dbl&gt; 234, 138, 0, 1014, 468, 1, 553, 58, 1, 236, 1, 104…\n$ `L-PFHxS80`         &lt;dbl&gt; 56, 26, 0, 197, 33, 0, 128, 16, 0, 4, 0, 80, 50, 1…\n$ `1-PFHxS`           &lt;dbl&gt; 1, 0, 0, 3, 1, 0, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,…\n$ `4/2-PFHxS`         &lt;dbl&gt; 8, 4, 0, 29, 4, 0, 19, 2, 0, 0, 0, 0, 0, 0, 2, 0, …\n$ `3-PFHxS`           &lt;dbl&gt; 2, 1, 0, 9, 1, 0, 6, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0,…\n$ sum_PFOS            &lt;dbl&gt; 328, 204, 0, 1545, 653, 1, 796, 80, 1, 270, 1, 990…\n$ sum_brPFOS          &lt;dbl&gt; 99, 64, 0, 500, 211, 0, 256, 25, 0, 47, 0, 14, 12,…\n$ sum_PFHxS           &lt;dbl&gt; 69, 33, 0, 252, 41, 0, 165, 20, 0, 4, 0, 82, 52, 6…\n$ sum_brPFHxS         &lt;dbl&gt; 11, 5, 0, 41, 6, 0, 27, 3, 0, 0, 0, 0, 0, 0, 2, 0,…\n$ sum_21PFAS          &lt;dbl&gt; 687, 370, 2, 2386, 880, 3, 1459, 172, 2, 284, 2, 1…\n\n  #select(ID, PFOS, PFOA, PFBS) |&gt; \n  #glimpse()\n\nHere, we apply a round transformation across all variables that are numeric."
  },
  {
    "objectID": "4_Tidyverse.html#tidyr",
    "href": "4_Tidyverse.html#tidyr",
    "title": "5  Tidyverse",
    "section": "5.2 tidyr",
    "text": "5.2 tidyr\n\n5.2.1 pivot_longer\nSee: https://tidyr.tidyverse.org/reference/pivot_longer.html\n\nPFAS_insects_long &lt;- PFAS_insects  |&gt;  # shortcut for pipe Ctrl + shift + M\n  pivot_longer(cols = PFBA:sum_21PFAS, # select all columns from PFBA to sum_21PFAS\n               names_to = \"PFAS\", # name of the new column\n               values_to = \"Conc\") |&gt;  #name of the values from PFBA:sum_21PFAS\n  mutate(PFAS = as.factor(PFAS)) #make PFAS column a factor variable\n\n\n#check the PFAS group names\nPFAS_insects_long |&gt; \n  group_by(PFAS) |&gt; \n  tally() |&gt; \n  glimpse() \n\nRows: 35\nColumns: 2\n$ PFAS &lt;fct&gt; 1-PFHxS, 1-PFOS 419/169, 10_2 FTSA, 3-PFHxS, 3/4/5-PFOS80/98.9, 4…\n$ n    &lt;int&gt; 108, 108, 108, 108, 108, 108, 108, 108, 108, 108, 108, 108, 108, …\n\n# select PFOS isomers\nPFOS_branched &lt;- c(\"1-PFOS 419/169\", \"3/4/5-PFOS80/98.9\")\n\nPFAS_insects_long |&gt;\n  filter(Group != \"Water\") |&gt; #remove water samples and only include solid samples\n  filter(str_detect(PFAS, \"sum_\", negate = TRUE)) |&gt; #remove all sum of PFAS using the argument by negate=TRUE \nggplot(aes(x = PFAS, y = Conc)) +\n  geom_point() +\n  geom_boxplot() +\n  theme_classic() +\n  ylab(\"Concentration of PFAS (ng/g) in solid samples\")"
  },
  {
    "objectID": "4_Tidyverse.html#ggplot2",
    "href": "4_Tidyverse.html#ggplot2",
    "title": "5  Tidyverse",
    "section": "5.3 ggplot2",
    "text": "5.3 ggplot2\nSee: https://github.com/rstudio/cheatsheets/blob/main/data-visualization.pdf\nggplot2 includes the general components:\n\ndata\nmappings (aesthetics)\ngeometric representation\nstatistics\nfacet\ncoordinate space\nlabels\ntheme\n\nExample:\nThis will produce similar plot as @sec-baseRplots\n\nggplot(data = PFAS_insects, mapping = aes(x = PFOA, y = PFOS)) +\n  geom_point(size = 2, colour = \"black\") + # add a scatter plot\n  geom_smooth(method = \"lm\", # uses the linear regression model\n              se = FALSE, # this will remove the confidence intervals\n              colour = \"blue\",\n              size = 2) +\n  geom_smooth(method = \"loess\",\n              se = FALSE,\n              colour = \"red\",\n              size = 2)\n\nWarning: Using `size` aesthetic for lines was deprecated in ggplot2 3.4.0.\nℹ Please use `linewidth` instead.\n\n\n`geom_smooth()` using formula = 'y ~ x'\n`geom_smooth()` using formula = 'y ~ x'\n\n\n\n\n\n\n5.3.1 NOT FINISHED (need to use same size scale for PFOS and PFBS)\nWe can add another geom by mapping again new variables (PFBS ~ PFOA)\n\nggplot(data = PFAS_insects) +\n  geom_point(mapping = aes(x = PFOA, y = PFOS, size = PFOS), colour = \"black\") + \n  geom_smooth(mapping = aes(x = PFOA, y = PFOS), \n              method = \"lm\", \n              se = FALSE, \n              colour = \"blue\",\n              size = 2) +\n  geom_smooth(mapping = aes(x = PFOA, y = PFOS), \n              method = \"loess\",\n              se = FALSE,\n              colour = \"red\",\n              size = 2) +\n  geom_point(mapping = aes(x = PFOA, y = PFBS, # new mapping\n                           size = PFBS), # size of points according to PFBS values\n             colour = \"pink\") + # colour outside of mappings\n  ylab(\"PFAS\") + \n  theme_classic() # This theme will remove the background colours and lines\n\n`geom_smooth()` using formula = 'y ~ x'\n`geom_smooth()` using formula = 'y ~ x'\n\n\n\n\n\nYou can add different layers based on conditions such as filtering the Conc variable by different colors.\n\n#options(scipen = 10000) #this avoids R to use scientific notation on values below 10000 \nPFAS_insects_long |&gt; \n  ggplot(aes(x = PFAS, y =  Conc)) +\n  geom_boxplot() +\n  geom_point(data = ~filter(.x, Conc &gt; 100), color = \"red\") +\n  geom_point(data = ~filter(.x, Conc &lt;= 100 & Conc &gt; 20), color = \"blue\") + \n  geom_point(data = ~filter(.x, Conc &lt;= 20), color = \"green\") +\n  scale_y_log10(labels = scales::label_number(accuracy = 0.01)) + \n  theme(axis.text.x = element_text(angle = -90, hjust = 0))"
  },
  {
    "objectID": "4_Tidyverse.html#stringr",
    "href": "4_Tidyverse.html#stringr",
    "title": "5  Tidyverse",
    "section": "5.4 stringr",
    "text": "5.4 stringr\nIn R, you need to escape certain special characters using \\.\nTest your regula expressions here: https://regex101.com/\nstr_detect This function will return TRUE is it matches a string statement.\n\nPFAS_insects_long |&gt; \n  mutate(PFCA = str_detect(PFAS, \"PF.*A\")) |&gt; \n  mutate(PFSA = str_detect(PFAS, \"PF.*S.*\")) |&gt; \n  glimpse()\n\nRows: 3,780\nColumns: 16\n$ ID                  &lt;chr&gt; \"W1\", \"W1\", \"W1\", \"W1\", \"W1\", \"W1\", \"W1\", \"W1\", \"W…\n$ `Full ID`           &lt;chr&gt; \"K1 W S17\", \"K1 W S17\", \"K1 W S17\", \"K1 W S17\", \"K…\n$ `Sampling site`     &lt;chr&gt; \"K1\", \"K1\", \"K1\", \"K1\", \"K1\", \"K1\", \"K1\", \"K1\", \"K…\n$ Number              &lt;dbl&gt; 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,…\n$ Group               &lt;chr&gt; \"Water\", \"Water\", \"Water\", \"Water\", \"Water\", \"Wate…\n$ Group_Family        &lt;chr&gt; \"Water 1_S17\", \"Water 1_S17\", \"Water 1_S17\", \"Wate…\n$ `g ww`              &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA…\n$ `g dw`              &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA…\n$ Quantity            &lt;chr&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA…\n$ `Extraction (mL_g)` &lt;dbl&gt; 509.3, 509.3, 509.3, 509.3, 509.3, 509.3, 509.3, 5…\n$ Year                &lt;dbl&gt; 2017, 2017, 2017, 2017, 2017, 2017, 2017, 2017, 20…\n$ Unit                &lt;chr&gt; \"ng L-1\", \"ng L-1\", \"ng L-1\", \"ng L-1\", \"ng L-1\", …\n$ PFAS                &lt;fct&gt; PFBA, PFPeA, PFBS, PFHxA, PFHpA, PFPeS80, PFHxS80,…\n$ Conc                &lt;dbl&gt; 27.4398194, 35.5252307, 81.7751816, 56.5295504, 25…\n$ PFCA                &lt;lgl&gt; TRUE, TRUE, FALSE, TRUE, TRUE, FALSE, FALSE, FALSE…\n$ PFSA                &lt;lgl&gt; FALSE, FALSE, TRUE, FALSE, FALSE, TRUE, TRUE, TRUE…\n\n\nThis function will create a new variable PFCA and check if the characters within the PFAS column matches anything that contain “PF.*A”. The “.*” matches any character in between “PF” and “A”. Similarily, the “PF.*S.* will return true for any string that contain the”PF” and “S” containing any characters in between these two strings and after “S”.\nstr_replace\nThis function replaces characters with another string. The str_replace will only replace the first match and ignore the rest even if these satisfy the match conditions, while str_replace_all will replace all match within the string.\n\nPFAS_insects_long |&gt; \n  mutate(PFAS = str_replace(PFAS, \"[Pp]\", \"_\")) |&gt; select(ID, PFAS) |&gt;  glimpse()\n\nRows: 3,780\nColumns: 2\n$ ID   &lt;chr&gt; \"W1\", \"W1\", \"W1\", \"W1\", \"W1\", \"W1\", \"W1\", \"W1\", \"W1\", \"W1\", \"W1\",…\n$ PFAS &lt;chr&gt; \"_FBA\", \"_FPeA\", \"_FBS\", \"_FHxA\", \"_FHpA\", \"_FPeS80\", \"_FHxS80\", …\n\nPFAS_insects_long |&gt; \n  mutate(PFAS = str_replace_all(PFAS, \"[Pp]\", \"_\")) |&gt; select(ID, PFAS) |&gt; glimpse()\n\nRows: 3,780\nColumns: 2\n$ ID   &lt;chr&gt; \"W1\", \"W1\", \"W1\", \"W1\", \"W1\", \"W1\", \"W1\", \"W1\", \"W1\", \"W1\", \"W1\",…\n$ PFAS &lt;chr&gt; \"_FBA\", \"_F_eA\", \"_FBS\", \"_FHxA\", \"_FH_A\", \"_F_eS80\", \"_FHxS80\", …\n\n\nThe above codes will match upper [P] and lower case [p] in the PFAS column. You can see that str_replace only replaces the first [Pp] with an underscore while str_replace_all will replace all [Pp] within each string."
  },
  {
    "objectID": "4_Tidyverse.html#purr",
    "href": "4_Tidyverse.html#purr",
    "title": "5  Tidyverse",
    "section": "5.5 purr",
    "text": "5.5 purr\nhttps://purrr.tidyverse.org/\nmap\nhttps://purrr.tidyverse.org/reference/map.html: The map functions transform their input by applying a function to each element of a list or atomic vector and returning an object of the same length as the input."
  },
  {
    "objectID": "4_Tidyverse.html#writing-functions-with-tidyverse",
    "href": "4_Tidyverse.html#writing-functions-with-tidyverse",
    "title": "5  Tidyverse",
    "section": "5.6 Writing functions with Tidyverse",
    "text": "5.6 Writing functions with Tidyverse\nWe can further reduce copy-paste repetition by wrapping our dplyr workflow into a function.\n\nPFAS_insects_long |&gt;\n  filter(Group != \"Water\") |&gt; #remove all water samples to only include solid samples\n  filter(str_detect(PFAS, \"sum_\", negate = TRUE)) |&gt; #remove all sum of PFAS using the argument: negate=TRUE \nggplot(aes(x = PFAS, y = Conc)) +\n  geom_point() +\n  geom_boxplot() +\n  theme_classic() \n\nWe cannot wrap this workflow directly in a function. Below code will throw an error.\n\nplotPFAS &lt;- function(mydata, mygroup, x_var, y_var){\n  mydata |&gt;\n  filter(Group != mygroup) |&gt; \n  filter(str_detect(PFAS, \"sum_\", negate = TRUE)) |&gt; #remove all sum of PFAS using the argument: negate=TRUE \nggplot(aes(x = x_var, y = y_var)) +\n    geom_point() +\n    geom_boxplot() +\n    ylab(paste0(\"Concentration of PFAS in \", mygroup)) + \n    theme_classic() \n}\n\nplotPFAS(mydata = PFAS_insects_long, mygroup = \"Water\", x_var = PFAS, y_var = Conc)\n\nError in `geom_point()`:\n! Problem while computing aesthetics.\nℹ Error occurred in the 1st layer.\nCaused by error:\n! object 'PFAS' not found\n\n\nYou cannot directly use the variable names in a function when using the dplyr codes with the pipe. Instead the variables should be embraced {{}} as below code shows.\n\n5.6.1 Embrace {{}}\n\nplotPFAS &lt;- function(mydata, mygroup, x_var, y_var){\n  mydata |&gt;\n  filter(Group != {{mygroup}}) |&gt; \n  filter(str_detect(PFAS, \"sum_\", negate = TRUE)) |&gt; #remove all sum of PFAS using the argument: negate=TRUE \nggplot(aes(x = {{x_var}}, y = {{y_var}})) +\n    geom_point() +\n    geom_boxplot() +\n    ylab(paste0(\"Concentration of PFAS in \", {{mygroup}})) + \n  theme_classic() \n}\n\nplotPFAS(mydata = PFAS_insects_long, mygroup = \"Water\", x_var = PFAS, y_var = Conc)\n\n\n\n\nAnother example\n\n# use embracing when wrapping in a function;\n# see ?rlang::args_data_masking for more details\n\ntidy_eval_arrange &lt;- function(data, var) {\n  data %&gt;%\n    arrange({{ var }})\n}\n\ntidy_eval_arrange(PFAS_insects, PFOS) |&gt; select(ID, PFOS) |&gt; glimpse()\n\nRows: 108\nColumns: 2\n$ ID   &lt;chr&gt; \"W3\", \"P36\", \"W9\", \"S3\", \"SW10\", \"D10\", \"W6\", \"L13\", \"P35\", \"S1\",…\n$ PFOS &lt;dbl&gt; 0.1487718, 0.4887884, 0.5090367, 0.5269612, 0.5269612, 0.8086711,…\n\ntidy_eval_arrange(PFAS_insects, PFOA) |&gt; select(ID, PFOA) |&gt; glimpse()\n\nRows: 108\nColumns: 2\n$ ID   &lt;chr&gt; \"L13\", \"S3\", \"SW4\", \"SW5\", \"SW6\", \"P36\", \"D28\", \"S1\", \"B2 D5\", \"B…\n$ PFOA &lt;dbl&gt; 0.02170220, 0.03321067, 0.03321067, 0.03321067, 0.03321067, 0.045…"
  },
  {
    "objectID": "Appendix_Version_control.html",
    "href": "Appendix_Version_control.html",
    "title": "6  Version control using Git and Github",
    "section": "",
    "text": "6.0.1 Step-by-step instructions\nThis guide to install and use Git and Github follows the guide: https://happygitwithr.com\nYou should consult this website for more detailed instructions.\n\n\n6.0.2 1. Register a Github account\nRegister a github account: https://github.com\n\n\n6.0.3 2. Install Git\na. Download git for Windows here: https://gitforwindows.org/\n\nNOTE: When asked about “Adjusting your PATH environment”, make sure to select “Git from the command line and also from 3rd-party software”.\nNote that RStudio for Windows prefers for Git to be installed below C:/Program Files and this appears to be the default. This implies, for example, that the Git executable on my Windows system is found at C:/Program Files/Git/bin/git.exe. Unless you have specific reasons to otherwise, follow this convention.\n\nb. Install a Git client, such as GithubDesktop: https://desktop.github.com/\n\n\n6.0.4 3. Set up keys for SSH\na. Create an SSH key pair\n\nIn RStudio, go to Tools &gt; Global Options…&gt; Git/SVN &gt; Create RSA Key….\n\nPassphrase is optional and needed when you want extra security\n\nAfter setting up the SSH key, Go to Tools &gt; Global Options…&gt; Git/SVN. click “View public key”. Copy the key text to your clipboard (Ctrl+c).\n\nb. On Github: - Click on your profile pic in upper right corner - Go to Settings &gt; SSH and GPG keys. Click “New SSH key”. - Paste your public key in the “Key” box. Give it an informative title, presumably repeating the descriptive comment (such as RStudio_LiU) you used above, during key creation. - Click “Add SSH key”.\n\n\n6.0.5 4. Connect your project to GitHub\nIt is recommended to first create a new repository in Github and then link it to a new project in Rstudio GitHub first, then RStudio or link an existing project to the created repository Existing project, GitHub first\n\na. GitHub first, then RStudio: follow these steps: https://happygitwithr.com/new-github-first#make-a-repo-on-github-2"
  },
  {
    "objectID": "Appendix_Quarto.html#publish-your-quarto-book-in-posit-cloud",
    "href": "Appendix_Quarto.html#publish-your-quarto-book-in-posit-cloud",
    "title": "7  Publish your data analysis in Quarto",
    "section": "7.1 Publish your Quarto book in Posit Cloud",
    "text": "7.1 Publish your Quarto book in Posit Cloud\nYou can directly publish your quarto book or website to Posit Cloud. You need to create an account to enable publishing of your website.\n\nMake sure to click on the Render Book button on the Build tab to update the book with the newest changes.\nClick the Publish the application or document button (next to the Run button)\n\nCheck: https://quarto.org/docs/publishing/posit-cloud.html"
  },
  {
    "objectID": "Appendix_Quarto.html#publish-your-quarto-book-in-github",
    "href": "Appendix_Quarto.html#publish-your-quarto-book-in-github",
    "title": "7  Publish your data analysis in Quarto",
    "section": "7.2 Publish your Quarto book in Github",
    "text": "7.2 Publish your Quarto book in Github\nEdit your _quarto.yml to output the generated html book into a folder.\n\nproject:\n  type: book\n  output-dir: docs\n\nThen follow the same steps below for websites"
  },
  {
    "objectID": "Appendix_Quarto.html#publish-your-quarto-webiste-in-github-pages",
    "href": "Appendix_Quarto.html#publish-your-quarto-webiste-in-github-pages",
    "title": "7  Publish your data analysis in Quarto",
    "section": "7.3 Publish your Quarto webiste in Github pages",
    "text": "7.3 Publish your Quarto webiste in Github pages\nTutorial: https://github.com/jtr13/website-template.\n\nYou’ve now left the template page and are viewing your new repo on GitHub. On the home page, click Settings. Click the “Pages” section on the left. In the Build and Deployment section, set Source to “Deploy from a branch” (Classic Pages experience) and Branch to main with /docs folder. Click Save.\nClick the little gear button near “About” on the top right side of the home page of the repo and check the “Use your Github Pages website” box under “Website”. Click “Save changes”. Test the link and you should see a web site with a stick figure on it. It may take a few minutes to build so if it’s not working do a few more steps and then come back to check.\nClick the green Code button, choose “HTTPS” and copy the link below."
  },
  {
    "objectID": "Appendix_DatabaseDesign.html",
    "href": "Appendix_DatabaseDesign.html",
    "title": "8  How to Design a Database",
    "section": "",
    "text": "https://www.youtube.com/watch?v=cepspxPAUTA\nHow do NoSQL databases work? Simply Explained!\nCreate MySQL Database - MySQL Workbench Tutorial\nhttps://www.youtube.com/watch?v=K6w0bZjl_Lw"
  },
  {
    "objectID": "Appendix_Kumla_PFAS.html",
    "href": "Appendix_Kumla_PFAS.html",
    "title": "9  Data analysis of Kumla PFAS study",
    "section": "",
    "text": "library(tidyverse)\nlibrary(readxl)\nlibrary(plotly)\nlibrary(EnvStats)\nlibrary(ggExtra)\nlibrary(ggforce)\nlibrary(FSA)\nlibrary(Hmisc)\nlibrary(corrplot)\nlibrary(RColorBrewer)\nlibrary(pheatmap)\nlibrary(rcompanion)\nlibrary(EnvStats)\nlibrary(ggrepel)\nlibrary(ggsignif)\nlibrary(ggpubr)\nlibrary(broom)\n\noptions(scipen=999)\noptions(digits = 3)\n\n\n### Loading raw data\n\n\n  #-----\n#Functions\nstanderror &lt;- function(x) {\n  se &lt;- sd(x, na.rm=TRUE)/sqrt(length(x[!is.na(x)]))\n}\n#-----\nPFAS_insects &lt;- readxl::read_excel(\"data/Statistics_Kumla_20200408.xlsx\", \n    sheet = \"Overview\")\n\nPFAS_insects &lt;- as_tibble(PFAS_insects) %&gt;%\n  mutate(Group = as.factor(Group)) %&gt;%\n  mutate(ID = as.factor(ID)) %&gt;%\n  mutate(`Sampling site`= as.factor(`Sampling site`)) %&gt;%\n  mutate(`Sampling site`= fct_relevel(`Sampling site`, \"K1\", \"KS\", \"KRef\")) %&gt;%\n  mutate(Group_Family = as.factor(Group_Family)) %&gt;%\n  mutate(`Sampling site` = as.factor(`Sampling site`)) %&gt;%\n  mutate(Group = as.factor(Group)) %&gt;%\n  mutate_if(is.numeric, round, 3) #round all numeric columns\n  \n\nkumla_isotopes &lt;- as_tibble(read_excel(\"data/Statistics_Kumla_20200408.xlsx\", \n                                 sheet = \"Overiew Iso\")) %&gt;%\n  mutate(Group = as.factor(Group)) %&gt;%\n  mutate(`Sampling site`= as.factor(`Sampling site`)) %&gt;%\n  mutate(Group_Family = as.factor(Group_Family)) %&gt;%\n  mutate(`Sampling site` = as.factor(`Sampling site`)) %&gt;%\n  mutate_if(is.numeric, round, 2) %&gt;% #round all numeric columns\n  select(1:8)\n\n\nkumla_isotopes_all&lt;- kumla_isotopes %&gt;%\n  group_by(Group) %&gt;%\n  summarise(n = n(),\n            min_d13C = min(delta13C), \n            min5_d13C = quantile(delta13C, 0.05),\n            mean_d13C = mean(delta13C),\n            median_d13C = quantile(delta13C, 0.5),\n            max95_d13C = quantile(delta13C, 0.95),\n            max_d13C = max(delta13C),\n            min_d15N = min(delta15N),\n            min5_d15N = quantile(delta15N, 0.05),\n            mean_d15N = mean(delta15N),\n            median_d15N = quantile(delta15N, 0.5),\n            max95_d15N = quantile(delta15N, 0.95),\n            max_d15N = max(delta15N),\n            se_d15N = standerror(delta15N),\n            se_d13C = standerror(delta13C),\n            lb_d13C = mean_d13C-se_d13C,\n            ub_d13C = mean_d13C+se_d13C,\n            lb_d15N = mean_d15N-se_d15N,\n            ub_d15N = mean_d15N+se_d15N\n        )\n\nkumla_isotopes_K1 &lt;- kumla_isotopes %&gt;%\n  filter(`Sampling site`== \"K1\") %&gt;%\n  group_by(Group) %&gt;%\n  summarise(n = n(),\n            min_d13C = min(delta13C), \n            min5_d13C = quantile(delta13C, 0.05),\n            mean_d13C = mean(delta13C),\n            median_d13C = quantile(delta13C, 0.5),\n            max95_d13C = quantile(delta13C, 0.95),\n            max_d13C = max(delta13C),\n            min_d15N = min(delta15N),\n            min5_d15N = quantile(delta15N, 0.05),\n            mean_d15N = mean(delta15N),\n            median_d15N = quantile(delta15N, 0.5),\n            max95_d15N = quantile(delta15N, 0.95),\n            max_d15N = max(delta15N),\n            se_d15N = standerror(delta15N),\n            se_d13C = standerror(delta13C),\n            lb_d13C = mean_d13C-se_d13C,\n            ub_d13C = mean_d13C+se_d13C,\n            lb_d15N = mean_d15N-se_d15N,\n            ub_d15N = mean_d15N+se_d15N\n        )\n\nkumla_isotopes_KS &lt;- kumla_isotopes %&gt;%\n  filter(`Sampling site`== \"KS\") %&gt;%\n  group_by(Group) %&gt;%\n  summarise(n = n(),\n            min_d13C = min(delta13C), \n            min5_d13C = quantile(delta13C, 0.05),\n            mean_d13C = mean(delta13C),\n            median_d13C = quantile(delta13C, 0.5),\n            max95_d13C = quantile(delta13C, 0.95),\n            max_d13C = max(delta13C),\n            min_d15N = min(delta15N),\n            min5_d15N = quantile(delta15N, 0.05),\n            mean_d15N = mean(delta15N),\n            median_d15N = quantile(delta15N, 0.5),\n            max95_d15N = quantile(delta15N, 0.95),\n            max_d15N = max(delta15N),\n            se_d15N = standerror(delta15N),\n            se_d13C = standerror(delta13C),\n            lb_d13C = mean_d13C-se_d13C,\n            ub_d13C = mean_d13C+se_d13C,\n            lb_d15N = mean_d15N-se_d15N,\n            ub_d15N = mean_d15N+se_d15N\n        )\n\nkumla_isotopes_KRef &lt;- kumla_isotopes %&gt;%\n  filter(`Sampling site`== \"KRef\") %&gt;%\n  group_by(Group) %&gt;%\n  summarise(n = n(),\n            min_d13C = min(delta13C), \n            min5_d13C = quantile(delta13C, 0.05),\n            mean_d13C = mean(delta13C),\n            median_d13C = quantile(delta13C, 0.5),\n            max95_d13C = quantile(delta13C, 0.95),\n            max_d13C = max(delta13C),\n            min_d15N = min(delta15N),\n            min5_d15N = quantile(delta15N, 0.05),\n            mean_d15N = mean(delta15N),\n            median_d15N = quantile(delta15N, 0.5),\n            max95_d15N = quantile(delta15N, 0.95),\n            max_d15N = max(delta15N),\n            se_d15N = standerror(delta15N),\n            se_d13C = standerror(delta13C),\n            lb_d13C = mean_d13C-se_d13C,\n            ub_d13C = mean_d13C+se_d13C,\n            lb_d15N = mean_d15N-se_d15N,\n            ub_d15N = mean_d15N+se_d15N\n        )\n\n\n\n\n# Colors\n## Set color palette\n# c12 &lt;- c(\n#   \"dodgerblue2\", \n#   \"#E31A1C\", # red\n#   \"#6A3D9A\", # purple\n#   \"#FF7F00\", # orange\n#   \"gold1\",\n#   \"#FB9A99\", # lt pink\n#   \"gray35\", \n#   \"maroon\", \n#   \"deeppink1\", \n#   \"blue1\", \n#   \"brown\",\n#   \"black\")\n\n\n#Alina color palette\nc12 &lt;- c(\n  \"cadetblue2\", \n  \"dodgerblue3\",\n  \"darkolivegreen2\",\n  \"darkorange\",\n  \"darkslategrey\",\n  \"forestgreen\",\n  \"goldenrod3\", \n  \"chocolate4\", \n  \"darkorchid4\", \n  \"deeppink1\", \n  \"darkslategray1\",\n  \"darkblue\")\n\n# pie(rep(1, 11), col = c11)\n\n#color\nmatrix_color &lt;- setNames(c12, c(levels(PFAS_insects$Group)))\nmatrix_color2 &lt;- setNames(c12, c(levels(kumla_isotopes$Group)))\n\n\n\n### Grouping homologs and isomers\n\nPFCAs &lt;- c(\"PFHpA\", \"PFOA\", \"PFNA\", \"PFDA\", \"PFUnDA\", \"PFDoDA\", \"PFTrDA\")\nPFSAs &lt;- c(\"PFBS\",  \"sum_PFHxS\",    \"PFHpS80\",  \"sum_PFOS\", \"PFNS80\",   \"PFDS80\",   \"PFOSA\")\nFTSAs &lt;- c(\"6_2_FTSA\",  \"8_2_FTSA\", \"10_2_FTSA\") \n# lin_PFCAs &lt;- c(\"PFBA\", \"PFPeA\", \"PFHxA\",  \"PFHpA\", \"PFOA\", \"PFNA\", \"PFDA\", \"PFUnDA\", \"PFDoDA\", \"PFTrDA\", \"PFTDA\", \"PFHxDA\", \"PFOcDA\")\n# lin_PFSAs &lt;- c(\"PFBS\",    \"PFPeS\", \"PFHxS\",   \"PFHpS\",    \"PFOS\", \"PFNS\", \"PFDS\", \"PFDoDS\")\n# FTSAs &lt;- c(\"FTSA42\",  \"FTSA62\",   \"FTSA82\")\n# lin_PFASs &lt;- c(\"PFBA\", \"PFPeA\", \"PFHxA\",  \"PFHpA\", \"PFOA\", \"PFNA\", \"PFDA\", \"PFUnDA\", \"PFDoDA\", \"PFTrDA\", \"PFTDA\", \"PFHxDA\", \"PFOcDA\",\n#             \"PFBS\",   \"PFPeS\", \"PFHxS\",   \"PFHpS\",    \"PFOS\", \"PFNS\", \"PFDS\", \"PFDoDS\",\n#             \"FTSA42\", \"FTSA62\",   \"FTSA82\")\n# \n# \nPFHxS_iso &lt;- c(\"L-PFHxS80\", \"1-PFHxS\", \"4/2-PFHxS\", \"3-PFHxS\")\nPFOS_iso &lt;- c(\"3/4/5-PFOS80/98.9\", \"6/2-PFOS169/80\", \"1-PFOS 419/169\", \"L-PFOS 99/169\")\n\n\n\n\n## END START CHUNK ## \n\n\n# PFAS histograms\n\n\n# Shapiro-Wilk test for normality \n\ndf_shapiro_ID &lt;- PFAS_insects %&gt;%\n  select(ID, sum_21PFAS) %&gt;%\n  filter()\n \n\nshapiro.test(df_shapiro_ID$sum_21PFAS)\nhist(df_shapiro_ID$sum_21PFAS)\nshapiro.test(log10(df_shapiro_ID$sum_21PFAS))\n\nhist(log10(df_shapiro_ID$sum_21PFAS))\n\n\n# Shapiro-Wilk test for normality PFOS\n\ndf_shapiro &lt;- PFAS_insects %&gt;%\n  select(Group, sum_PFOS) %&gt;%\n  filter(Group == \"Emergent aquatic insects\")\n\nshapiro.test(df_shapiro$sum_PFOS)\nhist(df_shapiro$sum_PFOS)\nshapiro.test(log10(df_shapiro$sum_PFOS))\nhist(log10(df_shapiro$sum_PFOS))\n\n# Isotopes histograms\n\nkumla_isotopes %&gt;%\n  ggplot(aes(x =  delta15N)) +\n  geom_histogram(bins = 10) +\n  facet_wrap(~Group,scales = \"free\") +\n  theme_bw()\n\nkumla_isotopes %&gt;%\n  ggplot(aes(x =  delta13C)) +\n  geom_histogram(bins = 10) +\n  facet_wrap(~Group,scales = \"free\") +\n  theme_bw()\n\n\nisotope_raw_checkNormality &lt;- kumla_isotopes %&gt;%\n  select(Group, delta13C, delta15N) %&gt;%\n  filter(Group == \"Emergent aquatic insects\")\n\nshapiro.test(isotope_raw_checkNormality$delta13C)\nshapiro.test(isotope_raw_checkNormality$delta15N)\n\n\n\n# branched PFOS\n\nPFAS_insects %&gt;%\n  select(PFOS_iso) %&gt;%\n  ggplot(aes(x =  perc_sum_brPFOS)) +\n  geom_histogram(bins = 6) +\n  facet_wrap(~Matrix,scales = \"free\") +\n  theme_bw()\n\n\n#--------------------------------------\n\n#All sites\nkumla_isotopes %&gt;%\nggplot() +\n  geom_point(aes(x = delta13C, y = delta15N, color = Group, shape = `Sampling site`), size = 3, alpha = 0.5) + # raw points\n  scale_color_manual(name = \"Group\", values = matrix_color) +\n  scale_x_continuous(name = expression(paste(delta^{13},\"C (\\u2030)\"))) + \n  scale_y_continuous(name = expression(paste(delta^{15},\"N (\\u2030)\"))) + \n  #geom_text_repel(aes(x = mean_d13C, y = mean_d15N, color = Matrix, label = Matrix),\n  #                point.padding = 0.85, size = 5, show.legend = FALSE, nudge_x = 0.5, nudge_y = 0.5) +\n  geom_errorbar(data = kumla_isotopes_all, aes(x = mean_d13C, y = mean_d15N, color = Group, ymin = lb_d15N, ymax = ub_d15N), size = 1) +\n  geom_errorbarh(data = kumla_isotopes_all, aes(x = mean_d13C, y = mean_d15N, color = Group, xmin = lb_d13C, xmax = ub_d13C), size = 1) +\n  theme_bw(base_size = 16, base_family=\"serif\") + \n  theme(axis.text=element_text(size = 16),\n        legend.title = element_text(face = \"bold\", size = 16, hjust = 0.5),\n        legend.text = element_text(size = 14),\n        #legend.position= c(0.85, 0.25),\n        legend.background = element_blank(),\n        legend.box.background = element_rect(colour = \"black\"),\n        panel.grid.major = element_blank(), panel.grid.minor = element_blank()) \n  #facet_wrap(.~ `Sampling site`, scales = \"fixed\") # mean and error bar not correctly mapped\n\n\n\n\n#Individual sites: K1\nkumla_isotopes %&gt;%\n  filter(`Sampling site` == \"K1\") %&gt;%\nggplot() +\n  geom_point(aes(x = delta13C, y = delta15N, color = Group), size = 3, alpha = 0.5) + # raw points\n  scale_color_manual(name = \"Group\", values = matrix_color) +\n  scale_x_continuous(name = expression(paste(delta^{13},\"C (\\u2030)\"))) + \n  scale_y_continuous(name = expression(paste(delta^{15},\"N (\\u2030)\"))) + \n  #geom_text_repel(aes(x = mean_d13C, y = mean_d15N, color = Matrix, label = Matrix),\n  #                point.padding = 0.85, size = 5, show.legend = FALSE, nudge_x = 0.5, nudge_y = 0.5) +\n  geom_errorbar(data = kumla_isotopes_K1, aes(x = mean_d13C, y = mean_d15N, color = Group, ymin = lb_d15N, ymax = ub_d15N), size = 1) +\n  geom_errorbarh(data = kumla_isotopes_K1, aes(x = mean_d13C, y = mean_d15N, color = Group, xmin = lb_d13C, xmax = ub_d13C), size = 1) +\n  theme_bw(base_size = 16, base_family=\"serif\") + \n  theme(axis.text=element_text(size = 16),\n        legend.title = element_text(face = \"bold\", size = 16, hjust = 0.5),\n        legend.text = element_text(size = 14),\n        #legend.position= c(0.85, 0.25),\n        legend.background = element_blank(),\n        legend.box.background = element_rect(colour = \"black\"),\n        panel.grid.major = element_blank(), panel.grid.minor = element_blank()) \n  #facet_wrap(.~ `Sampling site`, scales = \"fixed\") # mean and error bar not correctly mapped\n\n#Individual sites: KS\nkumla_isotopes %&gt;%\n  filter(`Sampling site` == \"KS\") %&gt;%\n  filter(`Full ID` != \"K2 SW T1 trichoptera\") %&gt;% #remove trichoptera which had very low 13C\nggplot() +\n  geom_point(aes(x = delta13C, y = delta15N, color = Group), size = 3, alpha = 0.5) + # raw points\n  scale_color_manual(name = \"Group\", values = matrix_color) +\n  scale_x_continuous(name = expression(paste(delta^{13},\"C (\\u2030)\"))) + \n  scale_y_continuous(name = expression(paste(delta^{15},\"N (\\u2030)\"))) + \n  #geom_text_repel(aes(x = mean_d13C, y = mean_d15N, color = Matrix, label = Matrix),\n  #                point.padding = 0.85, size = 5, show.legend = FALSE, nudge_x = 0.5, nudge_y = 0.5) +\n  geom_errorbar(data = kumla_isotopes_KS, aes(x = mean_d13C, y = mean_d15N, color = Group, ymin = lb_d15N, ymax = ub_d15N), size = 1) +\n  geom_errorbarh(data = kumla_isotopes_KS, aes(x = mean_d13C, y = mean_d15N, color = Group, xmin = lb_d13C, xmax = ub_d13C), size = 1) +\n  theme_bw(base_size = 16, base_family=\"serif\") + \n  theme(axis.text=element_text(size = 16),\n        legend.title = element_text(face = \"bold\", size = 16, hjust = 0.5),\n        legend.text = element_text(size = 14),\n        #legend.position= c(0.85, 0.25),\n        legend.background = element_blank(),\n        legend.box.background = element_rect(colour = \"black\"),\n        panel.grid.major = element_blank(), panel.grid.minor = element_blank()) \n  #facet_wrap(.~ `Sampling site`, scales = \"fixed\") # mean and error bar not correctly mapped\n\nkumla_isotopes %&gt;%\n  filter(`Sampling site` == \"KS\") %&gt;%\n  plot_ly(x = ~delta13C, y = ~delta15N, color = ~Group) %&gt;%\n  add_markers(text = ~ `Full ID`)\n\n#Individual sites: KRef\nkumla_isotopes %&gt;%\n  filter(`Sampling site` == \"KRef\") %&gt;%\nggplot() +\n  geom_point(aes(x = delta13C, y = delta15N, color = Group), size = 3, alpha = 0.5) + # raw points\n  scale_color_manual(name = \"Group\", values = matrix_color) +\n  scale_x_continuous(name = expression(paste(delta^{13},\"C (\\u2030)\"))) + \n  scale_y_continuous(name = expression(paste(delta^{15},\"N (\\u2030)\"))) + \n  #geom_text_repel(aes(x = mean_d13C, y = mean_d15N, color = Matrix, label = Matrix),\n  #                point.padding = 0.85, size = 5, show.legend = FALSE, nudge_x = 0.5, nudge_y = 0.5) +\n  geom_errorbar(data = kumla_isotopes_KRef, aes(x = mean_d13C, y = mean_d15N, color = Group, ymin = lb_d15N, ymax = ub_d15N), size = 1) +\n  geom_errorbarh(data = kumla_isotopes_KRef, aes(x = mean_d13C, y = mean_d15N, color = Group, xmin = lb_d13C, xmax = ub_d13C), size = 1) +\n  theme_bw(base_size = 16, base_family=\"serif\") + \n  theme(axis.text=element_text(size = 16),\n        legend.title = element_text(face = \"bold\", size = 16, hjust = 0.5),\n        legend.text = element_text(size = 14),\n        #legend.position= c(0.85, 0.25),\n        legend.background = element_blank(),\n        legend.box.background = element_rect(colour = \"black\"),\n        panel.grid.major = element_blank(), panel.grid.minor = element_blank()) \n  #facet_wrap(.~ `Sampling site`, scales = \"fixed\") # mean and error bar not correctly mapped\n\nANOVA and post hocs for d15N and d13C isotopes\nValues sharing a letter are not significantly different\n\n#------------ISotopes \n\n\n#---------sumPFAS\n\nconc_PFAS_pond &lt;- conc_PFAS %&gt;%\n  filter(Site == \"Pond\") %&gt;%\n  filter(!Matrix %in% c(\"Water\", \"Part. matter\")) %&gt;%\n  filter(!Matrix %in% c(\"Sed.\", \"Soil\", \"Aq. plants\", \"Aq. biofilm\", \"Aq. biofilm water\")) %&gt;%\n  mutate(Matrix = as.factor(Matrix))\n  # %&gt;%\n  # group_by(Matrix) %&gt;%\n  # tally()\n\nkruskal.test(conc_PFAS_pond$Sum24_TPFASs ~ conc_PFAS_pond$Matrix)\nPT_PFAS &lt;- dunnTest(Sum24_TPFASs ~ Matrix, data = conc_PFAS_pond, method = \"bh\")\nPT_PFAS &lt;- PT_PFAS$res\ncldList(comparison = PT_PFAS$Comparison,\n        p.value    = PT_PFAS$P.adj,\n        threshold  = 0.05,\n        remove.space = TRUE)\n\n\n## Pond vs creek of sumPFAS for terr. predators\nconc_PFAS_terr_pred_pond &lt;- conc_PFAS %&gt;%\n  filter(Matrix == \"Terr. inv. predators\") %&gt;%\n  filter(Site == \"Pond\")\n\nconc_PFAS_terr_pred_creek &lt;- conc_PFAS %&gt;%\n  filter(Matrix == \"Terr. inv. predators\") %&gt;%\n  filter(Site == \"Sörbybäcken\")\n\n# t-test on aquatic vs terrestrial for pond\nt.test(conc_PFAS_terr_pred_pond$Sum24_TPFASs, conc_PFAS_terr_pred_creek$Sum24_TPFASs, alternative = \"two.sided\", var.equal = F)\nwilcox.test(conc_PFAS_terr_pred_pond$Sum24_TPFASs, conc_PFAS_terr_pred_creek$Sum24_TPFASs)\n\n## PFOS\n\nkruskal.test(conc_PFAS_pond$PFOS ~ conc_PFAS_pond$Matrix)\nPT_PFOS &lt;- dunnTest(PFOS ~ Matrix, data = conc_PFAS_pond, method = \"bh\")\nPT_PFOS &lt;- PT_PFOS$res\ncldList(comparison = PT_PFOS$Comparison,\n        p.value    = PT_PFOS$P.adj,\n        threshold  = 0.05,\n        remove.space = TRUE)\n\n\n\n\n\n\n#-------branched isomers\n#brPFOS\n\nisomer_PFOS_pond &lt;- isomer_PFOS %&gt;%\n  filter(Site == \"Pond\") %&gt;%\n  filter(!matrix %in% c(\"Sed.\", \"Soil\", \"Aq. plants\"))\n  # group_by(matrix) %&gt;%\n  # tally()\n  \nkruskal.test(isomer_PFOS_pond$perc_sum_br_PFOS ~ isomer_PFOS_pond$Matrix)\nPT_brPFOS &lt;- dunnTest(perc_sum_br_PFOS ~ matrix, data = isomer_PFOS_pond, method = \"bh\")\nPT_brPFOS &lt;- PT_brPFOS$res\ncldList(comparison = PT_brPFOS$Comparison,\n        p.value    = PT_brPFOS$P.adj,\n        threshold  = 0.05,\n        remove.space = TRUE)\n\n# gives non-sign difference between part matter and water which is strange. check using Mann-Whitney\n\nisomer_PFOS_pond_MannU &lt;- isomer_PFOS_pond %&gt;%\n  select(Matrix, perc_sum_br_PFOS) %&gt;%\n  filter(Matrix == \"Part. matter\" | Matrix == \"Water\")\n\npartMater &lt;- isomer_PFOS_pond_MannU %&gt;%\n  filter(Matrix == \"Part. matter\") %&gt;%\n  select(perc_sum_br_PFOS) %&gt;%\n  as_vector()\n\nwater &lt;- isomer_PFOS_pond_MannU %&gt;%\n  filter(Matrix == \"Water\") %&gt;%\n  select(perc_sum_br_PFOS) %&gt;%\n  as_vector()\n\n\nwilcox.test(water, partMater)\n\n\n# Tukey HSD\nisomer_anova &lt;- tidy(TukeyHSD(aov(perc_sum_br_PFOS ~ Matrix, data = isomer_PFOS_pond)))\ncldList(comparison = isomer_anova$comparison,\n        p.value    = isomer_anova$adj.p.value,\n        threshold  = 0.05,\n        remove.space = TRUE)\n\n#brPFHxS\n\nisomer_PFHxS_pond &lt;- isomer_PFHxS %&gt;%\n  filter(Site == \"Pond\") %&gt;%\n  filter(brPFHxS_perc &gt; 0) %&gt;%\n  filter(!Matrix %in% c(\"Sed.\", \"Soil\", \"Aq. plants\"))\n  # group_by(Matrix) %&gt;%\n  # tally()\n  \nkruskal.test(isomer_PFHxS_pond$brPFHxS_perc ~ isomer_PFHxS_pond$Matrix)\nPT_brPFHxS &lt;- dunnTest(brPFHxS_perc ~ Matrix, data = isomer_PFHxS_pond, method = \"bh\")\nPT_brPFHxS &lt;- PT_brPFHxS$res\ncldList(comparison = PT_brPFHxS$Comparison,\n        p.value    = PT_brPFHxS$P.adj,\n        threshold  = 0.05,\n        remove.space = TRUE)\n\n\n\n\n#BAF aq\nBAF_aq_PFOS_pond &lt;- BAF_aq_PFOS %&gt;% filter(Site == \"Pond\") %&gt;% select(1, 8:12)\nBAF_aq_PFOS_pond_long &lt;- BAF_aq_PFOS_pond %&gt;% pivot_longer(-Name, names_to = \"isomer\", values_to = \"concentration\") %&gt;% mutate(isomer = as.factor(isomer))\nBAF_aq_PFHxS_pond &lt;- BAF_aq_PFHxS %&gt;% filter(Site == \"Pond\") %&gt;% select(1, 8:9)\nBAF_aq_PFHxS_pond_long &lt;- BAF_aq_PFHxS_pond %&gt;% pivot_longer(-Name, names_to = \"isomer\", values_to = \"concentration\")\n\n# Better documentation of what is done!: test something something...\nkruskal.test(list(BAF_aq_PFOS_pond$`dimetyl 80/99`, BAF_aq_PFOS_pond$`3/4/5-PFOS80/98.9`, BAF_aq_PFOS_pond$`6/2-PFOS169/80`,\n                  BAF_aq_PFOS_pond$`1-PFOS 419/169`, BAF_aq_PFOS_pond$`L-PFOS 99/169`))\n\n\nPT_BAF_PFOS &lt;- dunnTest(concentration ~ isomer, data = BAF_aq_PFOS_pond_long, method = \"bh\")\nPT_BAF_PFOS &lt;- PT_BAF_PFOS$res\ncldList(comparison = PT_BAF_PFOS$Comparison,\n        p.value    = PT_BAF_PFOS$P.adj,\n        threshold  = 0.05,\n        remove.space = TRUE)\n\n# Difference of BAF between PFHxS isomers\nkruskal.test(list(BAF_aq_PFHxS_pond$`L-PFHxS80`, BAF_aq_PFHxS_pond$`4/2-PFHxS`))\n\nCorrelations\n\nconc_PFAS %&gt;%\n  filter(Site == \"Pond\") %&gt;% \n  ggplot(aes(x = PFOS, y = `PFHxS`)) +\n  geom_point(aes(colour = Group_Order), size = 3, show.legend = NA) +\n  facet_wrap(~Matrix, scales = \"free\") + \n  theme_bw() +\n  theme(legend.position = \"bottom\")\n  \n\nres &lt;- conc_PFAS %&gt;%\n  filter(Site == \"Pond\") %&gt;%\n  select(ID, PFBA, PFPeA, PFHxA, PFHpA, PFOA, PFNA, PFDA, PFUnDA, PFBS, PFPeS, PFHxS, PFHpS, PFOS, PFNS, PFDS, `6_2 FTSA`)\n\nres &lt;- as.matrix(column_to_rownames(res, var = \"ID\"))\n\nres2 &lt;- cor(res, method = \"spearman\")\n\ncorrplot(res2, \n         method = \"circle\",\n         type = \"full\", \n         order = \"hclust\",\n         hclust.method = \"ward.D\",\n         sig.level = 0.05,\n         insig = \"pch\",\n         tl.col = \"black\", \n         tl.srt = 45)  \n  \ncorrplot.mixed(res2,\n               lower = \"number\",\n               upper = \"circle\",\n               lower.col = \"black\",\n               number.cex = 0.75,\n               tl.cex = 0.8\n               )\n  \npheatmap(res2,\n         cluster_rows = TRUE,\n         cluster_cols = TRUE,\n         scale = \"none\",\n         clustering_distance_rows = \"euclidean\",\n         clustering_method = \"ward.D\"\n         )\n\nBAFs\n\n##PFSAs\n\nBAF_aq %&gt;%\n  select(Name, Site, Matrix, Class, Order, PFSAs) %&gt;%\n  pivot_longer(cols = PFSAs, names_to = \"Homolog\", values_to = \"BAF\") %&gt;%\n  mutate(Homolog = as_factor(Homolog)) %&gt;%\n  ggplot(aes(x = Homolog, y = BAF)) +\n  geom_point(aes(color = Order)) +\n  facet_wrap(~Order, scales = \"free_y\") +\n  theme_bw(base_family=\"serif\") +\n  theme(legend.position = \"none\",\n        axis.text.x = element_text(color = \"black\", size = 14, angle = 90, hjust = .5, vjust = .5, face = \"plain\"),\n        axis.text.y = element_text(color = \"black\", size = 14, angle = 0, hjust = 1, vjust = 0, face = \"plain\"),\n        axis.title.x = element_text(color = \"black\", size = 16, angle = 0, hjust = .5, vjust = 0, face = \"plain\"),\n        axis.title.y = element_text(color = \"black\", size = 16, angle = 90, hjust = .5, vjust = .5, face = \"plain\"),\n        panel.grid.major = element_blank(), panel.grid.minor = element_blank())\n\n\n\n#PFCAs\nBAF_aq %&gt;%\n  select(Name, Site, Matrix, Class, Order, PFCAs) %&gt;%\n  pivot_longer(cols = PFCAs, names_to = \"Homolog\", values_to = \"BAF\") %&gt;%\n  mutate(Homolog = as_factor(Homolog)) %&gt;%\n  ggplot(aes(x = Homolog, y = BAF)) +\n  geom_point(aes(color = Order)) +\n  facet_wrap(~Order, scales = \"free_y\") +\n  theme_bw(base_family=\"serif\") +\n  theme(legend.position = \"none\",\n        axis.text.x = element_text(color = \"black\", size = 14, angle = 90, hjust = .5, vjust = .5, face = \"plain\"),\n        axis.text.y = element_text(color = \"black\", size = 14, angle = 0, hjust = 1, vjust = 0, face = \"plain\"),\n        axis.title.x = element_text(color = \"black\", size = 16, angle = 0, hjust = .5, vjust = 0, face = \"plain\"),\n        axis.title.y = element_text(color = \"black\", size = 16, angle = 90, hjust = .5, vjust = .5, face = \"plain\"),\n        panel.grid.major = element_blank(), panel.grid.minor = element_blank())\n\n\n#FTSAs\nBAF_aq %&gt;%\n  select(Name, Site, Matrix, Class, Order, FTSAs) %&gt;%\n  pivot_longer(cols = FTSAs, names_to = \"Homolog\", values_to = \"BAF\") %&gt;%\n  mutate(Homolog = as_factor(Homolog)) %&gt;%\n  ggplot(aes(x = Homolog, y = BAF)) +\n  geom_point(aes(color = Order)) +\n  facet_wrap(~Order, scales = \"free_y\") +\n  theme_bw(base_family=\"serif\") +\n  theme(legend.position = \"none\",\n        axis.text.x = element_text(color = \"black\", size = 14, angle = 90, hjust = .5, vjust = .5, face = \"plain\"),\n        axis.text.y = element_text(color = \"black\", size = 14, angle = 0, hjust = 1, vjust = 0, face = \"plain\"),\n        axis.title.x = element_text(color = \"black\", size = 16, angle = 0, hjust = .5, vjust = 0, face = \"plain\"),\n        axis.title.y = element_text(color = \"black\", size = 16, angle = 90, hjust = .5, vjust = .5, face = \"plain\"),\n        panel.grid.major = element_blank(), panel.grid.minor = element_blank())"
  }
]